window||(this.window=this);window.CodeEffects||(window.CodeEffects={typeName:"CodeEffects",getName:function(){return"CodeEffects"},__namespace:!0});CodeEffects.register||(CodeEffects.register=function(c){var e=window;c=c.split(".");for(var d=0;d<c.length;d++){var l=c[d],h=e[l];h||(h=e[l]={typeName:c.slice(0,d+1).join("."),__namespace:!0},h.getName=function(){return this.typeName});e=h}});CodeEffects.register("CodeEffects.Rule.Client");CodeEffects.register("CodeEffects.Rule.Models");CodeEffects.register("CodeEffects.Rule.Menu");
CodeEffects.register("CodeEffects.Rule.Calendar");CodeEffects.register("CodeEffects.Rule.Time");CodeEffects.register("CodeEffects.Rule.TextBox");var $rule=CodeEffects.Rule;$rule.Client.type={IE:0,Chrome:1,Firefox:2,Opera:3,Other:4};$rule.Client.browser=null;$rule.Client.version=Object.hasOwnProperty.call(window,"ActiveXObject")&&!window.ActiveXObject?11:0;
11==$rule.Client.version||navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("explorer")||-1<navigator.userAgent.indexOf(" MSIE ")?($rule.Client.browser=$rule.Client.type.IE,11!=$rule.Client.version&&($rule.Client.version=parseFloat(navigator.userAgent.match(/MSIE (\d+\.\d+)/)[1]))):-1<navigator.userAgent.toLowerCase().indexOf(" firefox/")?$rule.Client.browser=$rule.Client.type.Firefox:-1<navigator.userAgent.toLowerCase().indexOf(" applewebkit/")?$rule.Client.browser=$rule.Client.type.Chrome:
navigator.appName&&-1<navigator.appName.toLowerCase().indexOf("opera")||-1<navigator.userAgent.toLowerCase().indexOf("opera/")?$rule.Client.browser=$rule.Client.type.Opera:$rule.Client.browser=$rule.Client.type.Other;$rule.defined=function(c){return null!=c&&"undefined"!=typeof c&&"NaN"!=String(c)};
$rule.text=function(c,e){if(!c.tagName)return null;if($rule.defined(e))$rule.defined(document.getElementsByTagName("BODY")[0].innerText)?c.innerText=e.toString():c.textContent=e.toString();else return $rule.defined(document.getElementsByTagName("BODY")[0].innerText)?c.innerText:c.textContent};$rule.trim=function(c){return $rule.defined(c)&&0!==c.length?c.replace(/^\s+|\s+$/g,""):c};$rule.highlight=function(c){c.style.backgroundColor="#ffff91"};$rule.dim=function(c){c.style.backgroundColor=""};
$rule.getScrollBarWidth=function(){var c=document.createElement("DIV");c.style.width="100%";c.style.height="200px";var e=document.createElement("DIV");e.style.position="absolute";e.style.top=e.style.left="0px";e.style.width="200px";e.style.height="150px";$rule.Client.browser==$rule.Client.type.IE?e.style.visibility=e.style.overflow="":e.style.overflow="hidden";e.appendChild(c);document.body.appendChild(e);var d=c.offsetWidth;e.style.overflow=$rule.Client.browser==$rule.Client.type.IE?"scroll":"auto";
c=c.offsetWidth;$rule.Client.browser==$rule.Client.type.IE&&d==c&&(c=e.clientWidth);document.body.removeChild(e);return d-c};$rule.getElementWidth=function(c){return c.offsetWidth&&0<c.offsetWidth?c.offsetWidth:c.style.pixelWidth&&0<c.style.pixelWidth?c.style.pixelWidth:c.style.posWidth&&0<c.style.posWidth?c.style.posWidth:c.style.width&&0<c.style.width.length?parseInt(c.style.width.substr(0,c.style.width.length-2)):0};
$rule.getElementHeight=function(c){return $rule.defined(c.offsetHeight)&&0<c.offsetHeight?c.offsetHeight:$rule.defined(c.style.pixelHeight)&&0<c.style.pixelHeight?c.style.pixelHeight:$rule.defined(c.style.posHeight)&&0<c.style.posHeight?c.style.posHeight:$rule.defined(c.style.height)&&0<c.style.height.length?parseInt(c.style.height.substr(0,c.style.height.length-2),10):50};
$rule.getWindowDimensions=function(){var c=0,e=0;self.innerHeight?(c=window.innerHeight,e=window.innerWidth):document.documentElement&&document.documentElement.clientHeight?(c=document.documentElement.clientHeight,e=document.documentElement.clientWidth):document.body&&(c=document.body.clientHeight,e=document.body.clientWidth);return{height:parseInt(c,10),width:parseInt(e,10)}};
$rule.getScrollWidth=function(){var c=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft;return c?c:0};$rule.getScrollHeight=function(){var c=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;return c?c:0};
$rule.position=function(c,e){var d=$rule.getBounds(c),l=$rule.getBounds(e),h=$rule.getWindowDimensions(),p=$rule.getScrollHeight(),n=$rule.getScrollWidth();e.style.top=h.height>d.y-p+d.height+l.height?d.y+d.height+"px":h.height-l.height+p-4+"px";e.style.left=h.width>d.x-n+d.width+l.width?d.x+d.width+6+"px":h.width-l.width+n-4+"px"};
$rule.leftAlign=function(c,e){var d=$rule.getBounds(c),l=$rule.getBounds(e),h=$rule.getWindowDimensions(),p=$rule.getScrollWidth();e.style.left=h.width>d.x-p+d.width+l.width?d.x+"px":h.width-l.width+p-4+"px"};$rule.getType=function(c){if(!$rule.defined(c.constructor))throw Error("CL1");c=String(c.constructor).match(/function\s+(\w+)/);return $rule.defined(c)?c[1]:"undefined"};$rule.getDocument=function(c){c=c.ownerDocument||c.document||c;return c.defaultView||c.parentWindow};
$rule.getStyle=function(c){if(3===c.nodeType)return null;var e=$rule.getDocument(c);c.documentElement&&(c=c.documentElement);var d=e&&c!==e&&e.getComputedStyle?e.getComputedStyle(c,null):c.currentStyle||c.style;if(!d&&$rule.Client.browser==$rule.Client.type.Chrome&&c.style){var d=c.style.display,l=c.style.position;c.style.position="absolute";c.style.display="block";e=e.getComputedStyle(c,null);c.style.display=d;c.style.position=l;d={};if(e)for(c=0;c<e.length;c++)d[c]=e[c];d.display="none"}return d};
$rule.getParentById=function(c,e){return $rule.defined(c)?c.id&&c.id==e?c:c.parentNode?$rule.getParentById(c.parentNode,e):null:null};$rule.getParentByTagName=function(c,e,d){$rule.defined(d)||(d=0);return 0<d&&c.tagName&&c.tagName==e?c:c.parentNode?$rule.getParentByTagName(c.parentNode,e,++d):null};
$rule.getChildrenByTagName=function(c,e,d){var l=[],h;if(c.childNodes)for(var p=0;p<c.childNodes.length;p++)if(h=c.childNodes[p],h.tagName&&h.tagName==e&&l.push(h),d&&h.childNodes&&0<h.childNodes.length){h=$rule.getChildrenByTagName(h,e,d);for(var n=0;n<h.length;n++)l.push(h[n])}return l};
$rule.getChildrenByAttribute=function(c,e,d){var l=[],h,p;if(c.childNodes)for(var n=0;n<c.childNodes.length;n++)if(h=c.childNodes[n],h.tagName&&h.getAttribute&&(p=h.getAttribute(e),!p||$rule.defined(d)&&p!=d||l.push(h)),h.childNodes&&0<h.childNodes.length)for(h=$rule.getChildrenByAttribute(h,e,d),p=0;p<h.length;p++)l.push(h[p]);return l};
$rule.StringBuilder=function(){var c=[];this.append=function(e){e=$rule.defined(e)?$rule.getType(e)!=$rule.getType(new String)?String(e):e:"";0<e.length&&(c[c.length]=e)};this.dump=function(){return c.join("")}};$rule.Point=function(c,e){this.x=c;this.y=e};
switch($rule.Client.browser){case $rule.Client.type.Chrome:$rule.getPosition=function(c){if(c.window&&c.window===c||9===c.nodeType)return new $rule.Point(0,0);for(var e=0,d=0,l=null,h,p=c;p;l=h,p=p.offsetParent){h=$rule.getStyle(p);var n=p.tagName?p.tagName.toUpperCase():null;!p.offsetLeft&&!p.offsetTop||"BODY"===n&&l&&"absolute"===l.position||(e+=p.offsetLeft,d+=p.offsetTop)}h=(h=$rule.getStyle(c))?h.position:null;if(!h||"absolute"!==h)for(c=c.parentNode;c&&(n=c.tagName?c.tagName.toUpperCase():null,
"BODY"!==n&&"HTML"!==n&&(c.scrollLeft||c.scrollTop)&&(e-=c.scrollLeft||0,d-=c.scrollTop||0),!(h=(h=$rule.getStyle(c))?h.position:null)||"absolute"!==h);c=c.parentNode);return new $rule.Point(e,d)};break;case $rule.Client.type.Opera:$rule.getPosition=function(c){if(c.window&&c.window===c||9===c.nodeType)return new $rule.Point(0,0);for(var e=0,d=0,l=c;l;l=l.offsetParent)var h,e=e+(l.offsetLeft||0),d=d+(l.offsetTop||0);l=(l=c.style.position)&&"static"!==l;for(c=c.parentNode;c;c=c.parentNode)h=c.tagName?
c.tagName.toUpperCase():null,"BODY"===h||"HTML"===h||!c.scrollLeft&&!c.scrollTop||!l||"scroll"!==c.style.overflow&&"auto"!==c.style.overflow||(e-=c.scrollLeft||0,d-=c.scrollTop||0),h=c&&c.style?c.style.position:null,l=l||h&&"static"!==h;return new $rule.Point(e,d)};break;case $rule.Client.type.Firefox:$rule.getPosition=function(c){if(c.window&&c.window===c||9===c.nodeType)return new $rule.Point(0,0);for(var e=0,d=0,l=null,h=null,p,n=c;n;l=n,h=p,n=n.offsetParent){var B=n.tagName?n.tagName.toUpperCase():
null;p=$rule.getStyle(n);(n.offsetLeft||n.offsetTop)&&("BODY"!==B||h&&"absolute"===h.position)&&(e+=n.offsetLeft,d+=n.offsetTop);null!==l&&p&&("TABLE"!==B&&"TD"!==B&&"HTML"!==B&&(e+=parseInt(p.borderLeftWidth)||0,d+=parseInt(p.borderTopWidth)||0),"TABLE"!==B||"relative"!==p.position&&"absolute"!==p.position||(e+=parseInt(p.marginLeft)||0,d+=parseInt(p.marginTop)||0))}p=(p=$rule.getStyle(c))?p.position:null;if(!p||"absolute"!==p)for(c=c.parentNode;c;c=c.parentNode)if(B=c.tagName?c.tagName.toUpperCase():
null,"BODY"!==B&&"HTML"!==B&&(c.scrollLeft||c.scrollTop)&&(e-=c.scrollLeft||0,d-=c.scrollTop||0,p=$rule.getStyle(c)))e+=parseInt(p.borderLeftWidth)||0,d+=parseInt(p.borderTopWidth)||0;return new $rule.Point(e,d)};break;default:$rule.getPosition=function(c){if(c.self||9===c.nodeType)return new $rule.Point(0,0);var e={bottom:0,height:0,left:0,right:0,top:0,width:0};try{e=c.getBoundingClientRect()}catch(n){}if(!e)return new $rule.Point(0,0);var d=c.ownerDocument.documentElement,l=e.left-2+d.scrollLeft,
e=e.top-2+d.scrollTop;try{var h=c.ownerDocument.parentWindow.frameElement||null;if(h)var p="0"===h.frameBorder||"no"===h.frameBorder?2:0,l=l+p,e=e+p}catch(n){}return new $rule.Point(l,e)}}$rule.getBounds=function(c){var e=$rule.getPosition(c);return{x:e.x,y:e.y,width:$rule.getElementWidth(c),height:$rule.getElementHeight(c)}};
$rule.Json=function(){this.serialize=function(e){var d=new $rule.StringBuilder;c(e,d,!1);return d.dump()};this.deserialize=function(c){if(!$rule.defined(c)||0==c.length)throw Error("CL2");try{return eval("("+c.replace(/\\"/g,'"')+")")}catch(d){throw Error("CL41");}};var c=function(e,d){var l;switch(typeof e){case "number":isFinite(e)?d.append(e.toString()):d.append("null");break;case "string":d.append('"');d.append(e);d.append('"');break;case "boolean":d.append(e.toString());break;case "object":if($rule.defined(e))if($rule.getType(e)==
$rule.getType([])){d.append("[");for(l=0;l<e.length;++l)0<l&&d.append(","),c(e[l],d);d.append("]")}else{var h=[],p=0;for(l in e)h[p++]=l;d.append("{");var n=!1;for(l=0;l<p;l++){var B=e[h[l]];$rule.defined(B)&&"function"!==typeof B&&(n?d.append(","):n=!0,c(h[l],d),d.append(":"),c(B,d))}d.append("}")}else d.append("null");break;default:d.append("null")}}};
$rule.formatDate=function(c,e){function d(d){return 10>d?"0"+d:d.toString()}function l(d,c){for(var b=0,h=!1,e=0,l=d.length;e<l;e++){var n=d.charAt(e);switch(n){case "'":h?c.append("'"):b++;h=!1;break;case "\\":h&&c.append("\\");h=!h;break;default:c.append(n),h=!1}}return b}function h(d){return 10>d?"00"+d:100>d?"0"+d:d.toString()}if(!e||0===e.length||"i"===e)return c.toString();e=function(d){$rule.defined(d)||(d="d");if(1==d.length)switch(d){case "F":return"dddd, MMMM dd, yyyy h:mm:ss tt";case "s":return"yyyy'-'MM'-'dd'T'HH':'mm':'ss";
case "Y":case "y":return"MMMM, yyyy";case "M":case "m":return"MMMM dd";case "d":return"M/d/yyyy";case "D":return"dddd, MMMM dd, yyyy";case "t":return"h:mm tt";case "T":return"h:mm:ss tt";default:throw Error("CL61");}return d}(e);for(var p=new $rule.StringBuilder,n,B=0,z=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;;){var y=z.lastIndex;n=z.exec(e);y=e.slice(y,n?n.index:e.length);y=l(y,p);B+=y;if(!n)break;if(1===B%2)p.append(n[0]);else switch(n[0]){case "MMMM":p.append($rule.monthNames[c.getMonth()]);
break;case "MMM":p.append($rule.abbrMonthNames[c.getMonth()]);break;case "MM":p.append(d(c.getMonth()+1));break;case "M":p.append(c.getMonth()+1);break;case "dddd":p.append($rule.dayNames[c.getDay()]);break;case "ddd":p.append($rule.abbrDayNames[c.getDay()]);break;case "dd":p.append(d(c.getDate()));break;case "d":p.append(c.getDate());break;case "yyyy":p.append(c.getFullYear());break;case "yy":p.append(d(c.getFullYear()%100));break;case "y":p.append(c.getFullYear()%100);break;case "hh":n=c.getHours()%
12;0===n&&(n=12);p.append(d(n));break;case "h":n=c.getHours()%12;0===n&&(n=12);p.append(n);break;case "HH":p.append(d(c.getHours()));break;case "H":p.append(c.getHours());break;case "mm":p.append(d(c.getMinutes()));break;case "m":p.append(c.getMinutes());break;case "ss":p.append(d(c.getSeconds()));break;case "s":p.append(c.getSeconds());break;case "tt":p.append(12>c.getHours()?"AM":"PM");break;case "t":p.append(12>c.getHours()?"A":"P");break;case "f":p.append(h(c.getMilliseconds()).charAt(0));break;
case "ff":p.append(h(c.getMilliseconds()).substr(0,2));break;case "fff":p.append(h(c.getMilliseconds()));break;case "z":n=c.getTimezoneOffset()/60;p.append((0>=n?"+":"-")+Math.floor(Math.abs(n)));break;case "zz":n=c.getTimezoneOffset()/60;p.append((0>=n?"+":"-")+d(Math.floor(Math.abs(n))));break;case "zzz":n=c.getTimezoneOffset()/60,p.append((0>=n?"+":"-")+d(Math.floor(Math.abs(n)))+":"+d(Math.abs(c.getTimezoneOffset()%60)))}}return p.dump()};
Function.addDelegate=function(c,e){return function(){return e.apply(c,arguments)}};
$rule.Event=function(c){c=c||window.event;var e=this.type=c.type.toLowerCase();this.rawEvent=c;"keypress"==e&&(this.charCode=c.charCode||c.keyCode);c.keyCode?this.keyCode=46==c.keyCode&&"keypress"!=e?127:c.keyCode:c.charCode?this.keyCode=c.charCode:"undefined"!=typeof c.which&&(this.keyCode=c.which);this.offsetY=c.pageY?c.pageY:c.clientY+document.body.scrollTop-document.body.clientTop;this.target=c.target?c.target:c.srcElement};
$rule.Event.prototype={preventDefault:function(){this.rawEvent.preventDefault?this.rawEvent.preventDefault():window.event&&(this.rawEvent.returnValue=!1)},stopPropagation:function(){this.rawEvent.stopPropagation?this.rawEvent.stopPropagation():window.event&&(this.rawEvent.cancelBubble=!0)}};
$rule.addHandler=function(c,e,d){c.ceEvents||(c.ceEvents={});var l=c.ceEvents[e];l||(c.ceEvents[e]=l=[]);var h;c.addEventListener?(h=function(h){return d.call(c,new $rule.Event(h))},c.addEventListener(e,h,!1)):c.attachEvent&&(h=function(){var h={};try{h=$rule.getDocument(c).event}catch(e){}return d.call(c,new $rule.Event(h))},c.attachEvent("on"+e,h));l[l.length]={handler:d,browserHandler:h}};
$rule.addHandlers=function(c,e,d){for(var l in e){var h=e[l];d&&(h=Function.addDelegate(d,h));$rule.addHandler(c,l,h)}};
$rule.Context={controls:[],addControl:function(c,e){for(var d=0;d<$rule.Context.controls.length;d++)if($rule.Context.controls[d].id==c)throw Error("Code Effects control with specified ID already exist in the current context (CL85)");$rule.Context.controls.push(new $rule.Context.Item(c,e))},getControl:function(c){for(var e=0;e<$rule.Context.controls.length;e++)if($rule.Context.controls[e].id==c)return $rule.Context.controls[e].ref;return null}};$rule.Context.Item=function(c,e){this.id=c;this.ref=e};
var $ce=$rule.Context.getControl;$rule.Menu.Item=function(){this.Type=this.Name=this.ID=null};
$rule.Menu.Control=function(c){var e=$rule,d,l,h,p,n,B,z,y,k=null,q=!1,b=e.highlight,r=e.dim,W=e.getElementHeight,E=e.defined,K=e.Client.browser==e.Client.type.IE,t=e.Client.browser==e.Client.type.Opera;this.init=function(b,d){k=b;B=d;t?e.addHandlers(document,{keydown:C,keypress:U},k):e.addHandlers(document,{keydown:C},k)};this.close=function(){ha();B&&B()};this.select=function(b){if(d)for(var c=0;c<l.rows.length;c++)if(0===l.rows[c].cells[0].innerHTML.toLowerCase().lastIndexOf(b.toLowerCase(),0)){ca(l.rows[c]);
break}};this.fill=function(b,c,k,t,C,L){if(E(c)&&0!=c.length){q=!0;p=k;n=L;z=t;y=C;da(b);h=-1;d.style.width=l.style.width="";K||(d.style.height="");for(L=0;L<c.length;L++)C=c[L],k=l.insertRow(-1),k.id="ce104"+b.id+L,k.setAttribute("ce101",E(C.ID)?C.ID:""),k.setAttribute("ce102",E(C.Type)?C.Type:""),k.setAttribute("ce103",L),k.onclick=function(b){b=b||window.event;b.cancelBubble=!0;p&&p(this.getAttribute("ce101"),this.getAttribute("ce102"))},k.onmouseover=function(b){ca(this);n&&n(this.getAttribute("ce101"))},
k.onmouseout=function(b){r(this)},t=k.insertCell(-1),t.id="ce105"+b.id+L,K&&(k.style.height=8<e.Client.version?"22px":"23px",t.style.fontSize="13px",t.style.fontFamily="Tahoma,Geneva,Arial,sans-serif"),t.style.cursor="default",t.style.paddingLeft=t.style.paddingRight="8px",t.style.whiteSpace="nowrap",t.innerHTML=C.Name;0<l.rows.length?(k=12<c.length,t=W(l.rows[0]),E(t)&&0!=t||(t=22),d.style.height=t*(k?12:c.length)+"px",e.position(b,d),b=$rule.getBounds(l),d.style.width=(k?e.getScrollBarWidth()+b.width:
b.width)+"px",d.scrollTop=l.rows[0].offsetTop,d.onclick=function(b){b=b||window.event;b.cancelBubble=!0;return!1}):ha()}};this.alignLeft=function(b){E(d)&&E(b)&&e.leftAlign(b,d)};var C=function(b){var c=b.keyCode;if(!q||!E(d)||0==l.rows.length)return!0;switch(c){case 13:E(z)&&z();-1<h?p&&p(l.rows[h].getAttribute("ce101"),l.rows[h].getAttribute("ce102")):y&&y();break;case 32:-1<h&&p&&p(l.rows[h].getAttribute("ce101"),l.rows[h].getAttribute("ce102"));break;case 38:-1==h&&(h=0);if(0<=h){var e=l.rows[h].offsetTop-
d.scrollTop<l.rows[0].cells[0].clientHeight;h--;0>h&&(h=0);e&&(d.scrollTop=l.rows[h].offsetTop);La()}break;case 40:e=l.rows[0].cells[0].clientHeight,e=d.scrollTop+11*e-h*e<e,h++,h>l.rows.length-1&&(h=l.rows.length-1),e&&(d.scrollTop=l.rows[h-12+1].offsetTop),La()}t||8!=c&&9!=c&&13!=c&&32!=c&&33!=c&&34!=c&&35!=c&&36!=c&&38!=c&&40!=c||(b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation())},U=function(b){if(q&&E(d)&&0!=l.rows.length){var c=b.keyCode;8!=c&&9!=c&&13!=c&&32!=c&&33!=
c&&34!=c&&35!=c&&36!=c&&38!=c&&40!=c||b.preventDefault();return!1}return!0},La=function(){la();var d=l.rows[h];b(d);n&&n(d.getAttribute("ce101"))},ca=function(d){h=parseInt(d.getAttribute("ce103"),10);la();b(d)},da=function(b){l=document.createElement("TABLE");l.id="ce106"+b.id;d=document.createElement("DIV");d.id="ce107"+b.id;d.style.backgroundColor="#fff";E(c)&&(d.className=c);l.cellSpacing=0;l.cellPadding=2;l.border=0;d.style.position="absolute";d.style.padding="2px";d.style.overflow="auto";d.appendChild(l);
document.body.appendChild(d)},ha=function(){E(d)&&E(d.parentNode)&&d.parentNode.removeChild(d);q=!1},la=function(){for(var b=0;b<l.rows.length;b++)r(l.rows[b])}};$rule.Time.Settings=function(c){this.us=-1<c.indexOf("t");this.h=-1<c.indexOf("h")||-1<c.indexOf("H");this.m=-1<c.indexOf("m");this.s=-1<c.indexOf("s");this.dp=this.h||this.m||this.s};
$rule.Time.Picker=function(c){var e=$rule,d=null,l,h,p,n,B,z=!1,y,k,q,b=new Date;y=b.getHours();k=b.getMinutes();q=b.getSeconds();this.defaultFormat=function(){return d?d.defaultFormat():"hh:mm tt"};this.show=function(b,d,c,h,l){n=b;p=d;B=e.defined(c)?c:"hh:mm tt";z=h;e.defined(l)&&(y=l.getHours(),k=l.getMinutes(),q=l.getSeconds());r();E()};this.hide=function(){e.defined(l)&&e.defined(l.parentNode)&&l.parentNode.removeChild(l)};this.position=function(){E()};this.getId=function(){return e.defined(l)?
l.id:null};var r=function(){l=document.createElement("TABLE");l.id="ce110"+n.id;l.insertRow(-1).insertCell(-1);e.defined(c)&&(l.className=c);l.cellSpacing=0;l.cellPadding=2;l.style.position="absolute";h=document.createElement("TABLE");h.id="ce111"+n.id;h.setAttribute("ce108","true");h.cellSpacing=0;h.cellPadding=2;var b=h.insertRow(-1).insertCell(-1);b.style.padding="2px 6px 2px 6px";d=new e.Time.Control(b,B,W);d.setValue(y,k,q);l.rows[0].cells[0].appendChild(h);document.body.appendChild(l);l.onclick=
function(b){b=b||window.event;b.cancelBubble=!0;return!1}},W=function(){b=d.getRawValue();y=b.getHours();k=b.getMinutes();q=b.getSeconds();e.defined(p)&&p(d.getValue(),d.getText())},E=function(){e.defined(n)&&(e.position(n,l),z&&e.leftAlign(n,l))}};
$rule.Time.Control=function(c,e,d){function l(b,d,c){if(z.defined(b)&&z.defined(b.options)&&0!=b.options.length){for(var h=!1,e=0;e<b.options.length;e++)if(!c&&b.options[e].text==d||c&&b.options[e].value==d){b.selectedIndex=e;h=!0;break}h||(b.selectedIndex=0)}}function h(b){return z.defined(b)&&z.defined(b.options)&&-1!=b.selectedIndex?b.options[b.selectedIndex].value:null}function p(b){return z.defined(b)&&z.defined(b.options)&&-1!=b.selectedIndex?b.options[b.selectedIndex].text:null}function n(b,
d,c){var h=document.createElement("OPTION");h.text=d;h.value=c;z.Client.browser==z.Client.type.IE?b.options.add(h):b.appendChild(h)}function B(b,d,c,h){for(--d;d<c;d++){var e=d+1;n(b,h&&10>e?"0"+e:e,e)}}var z=$rule;e=z.defined(e)?e:"hh:mm tt";var y=new z.Time.Settings(e),k=function(){if(!y.h)return 0;if(y.us){var b=parseInt(h(r),10);return"AM"==h(K)?12==b?0:b:12==b?b:b+12}return parseInt(h(r),10)},q=function(b){var d=document.createElement("SELECT");d.id=b;d.style.width="44px";c.appendChild(d);B(d,
0,59,!0);return d},b=function(){var b=document.createElement("SPAN");b.innerHTML="<b>:</b>";b.style.marginLeft="2px";b.style.marginRight="2px";c.appendChild(b)},r=null,W=null,E=null,K=null;y.h&&(r=document.createElement("SELECT"),r.id="ce113"+c.id,r.style.width="44px",c.appendChild(r),y.us?(n(r,"12",12),B(r,1,11,!1)):B(r,0,23,!0));y.h&&y.m&&b();y.m&&(W=q("ce114"+c.id));y.s&&(b(),E=q("ce115"+c.id));y.h&&y.us&&(K=document.createElement("SELECT"),K.id="ce116"+c.id,K.style.width="44px",K.style.marginLeft=
"4px",c.appendChild(K),n(K,"AM","AM"),n(K,"PM","PM"));(function(){var b=document.createElement("INPUT");b.id="ce112"+c.id;b.type="button";b.style.marginLeft="4px";b.value="OK";c.appendChild(b);b.onclick=function(b){b=b||window.event;b.cancelBubble=!0;d()}})();this.defaultFormat=function(){return"hh:mm tt"};this.getRawValue=function(){return new Date("1/1/2000 "+k()+":"+(y.m?p(W):"00")+":"+(y.s?p(E):"00"))};this.getValue=function(){return z.formatDate(this.getRawValue(),"HH:mm:ss")};this.getText=function(){var b=
(y.h?p(r):"00")+":"+(y.m?p(W):"00")+":"+(y.s?p(E):"00")+(y.h&&y.us?" "+p(K):"");return z.formatDate(new Date("1/1/2000 "+b),e)};this.setValue=function(b,d,c){if(z.defined(b)&&z.defined(d)&&z.defined(c)&&0!=b.length&&0!=d.length&&0!=c.length){if(y.h)if(y.us){b=parseInt(b,10);var h=b-12;13>b?(h=0==b?12:b,l(K,"AM",!0)):l(K,"PM",!0);l(r,h,!0)}else 2>b.length?l(r,b,!0):l(r,b,!1);y.m&&(2>d.length?l(W,d,!0):l(W,d,!1));y.s&&(2>c.length?l(E,c,!0):l(E,c,!1))}else y.h&&(r.selectedIndex=0),y.m&&(W.selectedIndex=
0),y.s&&(E.selectedIndex=0),y.h&&y.us&&(K.selectedIndex=0)}};$rule.TextBox.Settings=function(c,e,d,l,h,p,n,B){this.parent=c;this.id=e;this.css=d;this.defCss=l;this.max=h;this.defVal=p;this.errVal=n;this.errColor=B};
$rule.TextBox.Control=function(){var c,e;this.init=function(d){e=d;c=document.createElement("INPUT");c.type="text";c.id=e.id;c.className=e.defCss;c.maxLength=e.max;c.value=e.defVal;e.parent.appendChild(c);c.onfocus=function(d){c.className=c.className.replace(" "+e.errColor,"");c.className=e.css;if(c.value.toLowerCase()==e.defVal.toLowerCase()||c.value.toLowerCase()==e.errVal.toLowerCase())c.value=""};c.onblur=function(d){d=$rule.trim(c.value);if(0==d.length||d.toLowerCase()==e.defVal.toLowerCase()||
d.toLowerCase()==e.errVal.toLowerCase())c.className=c.className.replace(" "+e.errColor,""),c.value=e.defVal,c.className=e.defCss}};this.getValue=function(){return c.value};this.setValue=function(d){c.value=d};this.setClass=function(d){c.className=d}};$rule.Calendar.Css=function(){this.container="ceCal";this.header="ceHeader";this.day="ceDay";this.today="ceToday";this.selected="ceSelected";this.dayRollover="ceRollover";this.weekDays="ceDays"};
$rule.Calendar.Control=function(){var c=$rule,e,d,l,h,p=!1,n=new c.Calendar.Css,B,z,y,k,q,b,r,W,E,K,t,C=new Date;B=C.getMonth();z=C.getFullYear();y=C.getHours();k=C.getMinutes();q=C.getSeconds();b=C.getDate();r=W=0;this.show=function(d,n,t,C,L){e=d;l=n;h=c.defined(t)?t:"MMM dd, yyyy";p=C;c.defined(L)&&(b=L.getDate(),W=z=L.getFullYear(),r=B=L.getMonth(),y=L.getHours(),k=L.getMinutes(),q=L.getSeconds());da();ya();U()};this.hide=function(){c.defined(t)&&c.defined(t.parentNode)&&t.parentNode.removeChild(t)};
this.position=function(){ya()};this.defaultFormat=function(){return"MMM dd, yyyy"};this.getId=function(){return c.defined(t)?t.id:null};var U=function(){var b=c.getChildrenByTagName(E.rows[0].cells[1],"SPAN",!1);b[0].innerHTML=c.abbrMonthNames[B];b[1].innerHTML=z;La()},La=function(){var d=new Date,e=new Date(z,B,1),k=d.getFullYear(),l=d.getMonth(),d=d.getDate(),e=e.getDay(),p,q=1,t,y=!0;p=1==B&&(0==z%4&&0!=z%100||0==z%400)?29:c.days[B];for(var C=1;C<K.rows.length;C++)for(var E=0;E<K.rows[C].cells.length;E++)t=
K.rows[C].cells[E],y=!0,1==C&&E>=e||1<C&&q<=p?(t.innerHTML=q,k==z&&l==B&&q==d&&c.defined(n.today)?(t.className=n.today,t.setAttribute("ce117",n.today),y=!1):z==W&&B==r&&q==b&&c.defined(n.selected)?(t.className=n.selected,t.setAttribute("ce117",n.selected),y=!1):c.defined(n.day)&&(t.className=n.day),y&&c.defined(n.day)&&t.setAttribute("ce117",n.day),t.onclick=function(d){var e=(new c.Time.Settings(h)).dp;e||(d=d||window.event,d.cancelBubble=!0);for(var k=1;k<K.rows.length;k++)for(var l=0;l<K.rows[k].cells.length;l++)d=
K.rows[k].cells[l],d.getAttribute("ce117")==n.today?d.className=n.today:(d.className=n.day,d.setAttribute("ce117",n.day));b=parseInt(c.text(this),10);this.className!=n.today&&c.defined(n.selected)&&(this.className=n.selected,this.setAttribute("ce117",n.selected));e||ca()},t.onmouseover=function(b){c.defined(n.dayRollover)&&(this.className=n.dayRollover)},t.onmouseout=function(b){b=this.getAttribute("ce117");c.defined(b)&&(this.className=b)},q++):(c.defined(n.day)&&(t.className=n.day),t.innerHTML=
"&nbsp;",t.onclick=t.onmouseover=t.onmouseout=null)},ca=function(){var e=B+1+"/"+b+"/"+z;C=new Date(e);B=C.getMonth();z=C.getFullYear();b=C.getDate();r=B;W=z;if((new c.Time.Settings(h)).dp){var n=d.getRawValue();y=n.getHours();k=n.getMinutes();q=n.getSeconds();e+=" "+y+":"+k+":"+q}c.defined(l)&&l(e)},da=function(){t=document.createElement("TABLE");t.id="ce120"+e.id;t.cellSpacing=0;t.cellPadding=1;var b=t.insertRow(-1),b=b.insertCell(-1);c.defined(n.container)&&(t.className=n.container);t.style.position=
"absolute";E=document.createElement("TABLE");E.id="ce121"+e.id;E.setAttribute("ce118","true");c.defined(n.header)&&(E.className=n.header);E.cellSpacing=E.cellPadding=0;E.style.width="100%";var l=E.insertRow(-1),p=l.insertCell(-1);p.style.padding="1px 0px 3px 6px";var r=la(p,"ce123"+e.id,"&#171;&#171;");r.style.marginRight="4px";r.onclick=function(b){b=b||window.event;b.cancelBubble=!0;--z;U()};p=la(p,"ce124"+e.id,"&#171;");p.style.marginLeft="2px";p.onclick=function(b){b=b||window.event;b.cancelBubble=
!0;0==B?(B=11,--z):--B;U()};r.style.cursor=p.style.cursor="pointer";p=l.insertCell(-1);p.style.width="90px";p.style.textAlign="center";p.style.padding="1px 0px 3px 0px";r=la(p,"ce125"+e.id,c.abbrMonthNames[B]);p=la(p,"ce126"+e.id,z);r.style.marginRight="2px";p.style.marginLeft="2px";r.style.cursor=p.style.cursor="default";r=l.insertCell(-1);r.style.padding="1px 6px 3px 0px";r.style.textAlign="right";l=la(r,"ce127"+e.id,"&#187;");l.style.marginRight="2px";l.onclick=function(b){b=b||window.event;b.cancelBubble=
!0;11==B?(B=0,++z):++B;U()};r=la(r,"ce128"+e.id,"&#187;&#187;");r.style.marginLeft="4px";r.onclick=function(b){b=b||window.event;b.cancelBubble=!0;++z;U()};r.style.cursor=l.style.cursor="pointer";b.appendChild(E);K=ha();document.body.appendChild(t);(new c.Time.Settings(h)).dp&&(b=t.insertRow(-1),b=b.insertCell(-1),b.style.padding="0 4px 6px 4px",b.style.textAlign="center",d=new c.Time.Control(b,h,ca),d.setValue(y,k,q))},ha=function(){var b=document.createElement("TABLE");b.id="ce148"+e.id;b.cellSpacing=
1;b.cellPadding=0;b.style.width="100%";for(var d,h,k=0;7>k;k++){d=b.insertRow(-1);for(var l=0;7>l;l++)h=d.insertCell(-1),0==k&&c.defined(n.weekDays)&&(h.className=n.weekDays),h.innerHTML="&nbsp;"}for(d=0;d<b.rows[0].cells.length;d++)b.rows[0].cells[d].innerHTML=c.abbrWeekDayNames[d];t.rows[0].cells[0].appendChild(b);return b},la=function(b,d,h){var e=document.createElement("SPAN");c.defined(d)&&(e.id=d);e.innerHTML=h;b.appendChild(e);return e},ya=function(){c.defined(e)&&(c.position(e,t),p&&c.leftAlign(e,
t))}};$rule.days=[31,28,31,30,31,30,31,31,30,31,30,31];$rule.dayNames="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");$rule.abbrDayNames="Sun Mon Tue Wed Thu Fri Sat".split(" ");$rule.abbrWeekDayNames="SMTWTFS".split("");$rule.monthNames="January February March April May June July August September October November December ".split(" ");$rule.abbrMonthNames="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec ".split(" ");
$rule.Settings=function(c){this.help=c.ui[0];this.isEval=c.ui[1];this.evalIf=c.ui[2];this.execIf=c.ui[3];this.tools=c.ui[4];this.pb=c.ui[5];this.tochki=c.ui[6];this.clicks=c.ui[7];this.titles=c.ui[8];this.right=c.ui[9];this.mode=c.ui[10];this.tId=c.ui[11];this.tUrl=c.ui[12];this.els=c.s;this.clientFlds=[];this.ruleCss="ceRule";this.menuCss="ceMenu";this.toolCss="ceToolBar";this.deleteCss="ceDeleteButton";this.saveButCss="ceSaveButton";this.rulesCss="ceRulesButton";this.descCss="ceDescriptionBox";
this.nameCss="ceNameBox";this.descDefCss="ceDescriptionBoxDefault";this.nameDefCss="ceNameBoxDefault";this.helpCss="ceHelp";this.timeCss="ceTime";this.flowCss="ceFlow";this.fieldCss="ceField";this.clauseCss="ceClause";this.operCss="ceOperator";this.skobkiCss="ceParenthesis";this.actionCss="ceAction";this.braceCss="ceBrace";this.valueCss=this.calcCss=this.paramCss="ceValue";this.tabCss="ceTab";this.lineCss="ceNewLine";this.currentBg="ceCurrent";this.invalidColor="ceError";this.highlightBg="ceHighlight";
this.warn="ceWarn";this.emptyColor="ceEmpty";this.cursorOuter="ceCursorOuter";this.cursorInner="ceCursorInner"};
$rule.Control=function(c){var e=$rule,d,l,h,p,n,B,z,y,k=null,q,b=null,r=null,W=[],E=[],K=[],t,C=null,U=null,La=null,ca,da,ha,la,ya,ja=!0,yb=!0,ib=null,Tb=null,L,ka,za=null,Ua=0,wc=!1,Ub=!1,ea=null,Va=!1,P=!1,ba=!1,J=!1,zb=0,qb=0,qa=0,Vb=0,Wb=0,M=this,g=e.defined,$a=new e.Json,wa,Wa,Ea,rb,Xb=e.getChildrenByAttribute,w=null,Ab,sb,tb,Yb=!1,Zb=!1,ab=null,$b=null,ac=null,bc=null,jb=!1,H=null,Xa=null,xc=null,Bb=c[0],cc=c[1],yc=c[2],Cb=c[3];M.loadSettings=function(a){Ab=a&&a.d||a;zc();return M};M.loadRule=
function(a){tb=a&&a.d||a;if(g(tb))return dc(),M};M.loadInvalids=function(a){sb=a&&a.d||a;if(g(sb))return ec(),M};M.setClientActions=function(a,f,b){$b=b;ac=f;bc=a;return M};M.getRuleId=function(){return ea};M.isEvaluationType=function(){return k?k.isEval:!0};M.saved=function(a){function f(a,f){return a.Name.localeCompare(f.Name)}function b(a,f){return a.n.localeCompare(f.n)}if(!jb)return M;!g(ea)&&g(a)&&(ea=a);g(ea)&&ea!=a&&Bc();var d=[],c=!1;if(k.tools){for(var h=0;h<K.length;h++)a=K[h],"ceEval"!=
a.ID&&"ceExec"!=a.ID&&(a.ID==ea&&(a.Name=Ya(ha.getValue()),c=!0),d.push({ID:a.ID,Name:a.Name}));c||(a=new e.Menu.Item,a.ID=ea,a.Name=Ya(ha.getValue()),d.push(a));d.sort(f);k.els.rls=d;Cc()}if(k.isEval){c=!1;for(d=0;d<w.fds.length;d++)if(a=w.fds[d],a.ir&&a.v==ea){a.n=Ya(ha.getValue());c=!0;break}c||(a={n:Ya(ha.getValue()),v:ea,o:4,t:1,ai:2,ir:!0,l:!1},w.fds.push(a));w.fds.sort(b)}return M};M.deleted=function(a){for(var f=[],b,d=0;d<K.length;d++)b=K[d],b.ID!=a&&f.push(b);K=f;if(k.isEval){f=[];for(d=
0;d<w.fds.length;d++)b=w.fds[d],b.v!=a&&f.push(b);w.fds=f}return M};M.extract=function(){ab="ceExtract";Va=!1;return $a.serialize(Db())};M.clear=function(){Dc();Ec();bb();return M};M.dispose=function(){Eb();return M};M.redraw=function(){Fc();Gc();return M};M.init=function(a){Ab=a;e.addHandlers(window,{load:zc},M)};M.load=function(a){g(a)&&(tb=a,e.addHandlers(window,{load:dc},M))};M.invalid=function(a){g(a)&&(sb=a,e.addHandlers(window,{load:ec},M))};M.valid=function(){fc();kb()};M.post=function(){gc()};
var zc=function(){k=new $rule.Settings($a.deserialize(Ab));Ab=null;if(!g(k.els.src)||0==k.els.src.length)throw Error("CL87");d=e.Client.ElementType;l=e.Client.FunctionType;z=e.Client.CollectionType;y=e.Client.SelectionType;h=e.Models.OperatorType;p=e.Client.InputType;n=e.Client.CalculationType;B=e.Common.ValueInputType;Wa=e.text;wa=$rule.getBounds;Ea=e.Client.browser==e.Client.type.IE;rb=e.Client.browser==e.Client.type.Opera;Wb=0;H=document.getElementById(Bb);Cb?xc=document.getElementById(Cb):jb=
!0;O(null);g(k.els.str)&&k.els.str.length||(k.els.str=[]);k.els.ens&&0<k.els.ens.length?Hc(k.els.ens,!0):k.els.ens=[];k.els.mds&&0<k.els.mds.length?Hc(k.els.mds,!1):k.els.mds=[];if(jb&&g(k.tId)&&g(k.tUrl)){var a=Xb(document,k.tId);0<a.length&&(a[0].href=k.tUrl)}k.els.ms=k.help&&g(e.Help)?e.Help:{};k.els.er=e.Errors;yc||jb||(Xa=e.getParentByTagName(H,"FORM"),g(Xa)&&e.addHandlers(Xa,{submit:gc},this));k.tools?(Cc(),Ic(!1),k.help?Jc(H,!0):Kc()):k.help?Ic(!0):(ca=document.getElementById("ceT"+H.id),g(ca)&&
ca.parentNode.removeChild(ca),ca=null);var a="_"+Bb,f=document.getElementById(a);g(f)||(f=document.createElement("DIV"),f.id=a);f.className=X(k.ruleCss);H.appendChild(f);H=f;Lc();q=2;t="";Fc();if(!wc){Ec();a=Xb(document.body,"ce002");if(g(a)&&0<a.length){if(hc)try{U=a[0],U.id=Ua+"",Ua++}catch(b){}for(f=0;f<a.length;f++)a[f].style.display="none"}if(hc){Mc();try{Tb=window.setInterval(Mc,400)}catch(b){throw Error("CL92");}}za=new e.Menu.Control(k.menuCss);L=new e.Calendar.Control;ka=new e.Time.Picker(k.timeCss);
e.addHandlers(document,{click:od},this);e.addHandlers(document,{keydown:pd,keypress:qd,keyup:rd},this);za.init(this,k.help?kb:null);e.addHandlers(window,{resize:Gc},this);wc=!0}Zb&&dc();Yb&&ec();Yb=Zb=!1},dc=function(){if(g(k)){var a=$a.deserialize(tb);if(0!=a.length){ea=a[0].g;k.isEval=a[0].v;if(k.tools){g(ea)&&Bc();var f=a[0].n,ma=a[0].d;g(f)&&0<f.length?(ha.setValue(Oa(f)),ha.setClass(X(k.nameCss))):(ha.setValue(Oa(k.els.lbl.n)),ha.setClass(X(k.nameDefCss)));g(ma)&&0<ma.length?(la.setValue(Oa(ma)),
la.setClass(X(k.descCss))):(la.setValue(Oa(k.els.lbl.d)),la.setClass(X(k.descDefCss)))}Ua=a.length+1;Nc();for(var m,c,Ba=null,u=null,D=0,t=0,x,z=null,B=1;B<a.length;B++){f=a[B];if(!g(f))break;x=!1;if(f.t==d.NewLine)cb(!1,!0);else if(f.t==d.Tab)I({t:f.t,id:null,v:"",n:"&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:!0});else{ma=g(f.n)?f.n:null;switch(f.t){case d.Flow:c=A(k.els.fls,f.v);if(!g(c)){alert("This rule cannot be properly loaded using the current Mode");return}switch(f.v){case "if":m=k.isEval?
k.evalIf:k.execIf;break;case "elseIf":m=4==k.mode?k.isEval?k.evalIf:k.execIf:c.n;break;default:m=c.n}break;case d.LeftSource:m=k.els.lbl.ub;break;case d.RightSource:m=k.els.lbl.ue;break;case d.LeftParenthesis:m=k.els.lbl.pb;break;case d.RightParenthesis:m=k.els.lbl.pe;break;case d.LeftBracket:m=k.els.lbl.cb;break;case d.RightBracket:m=k.els.lbl.ce;break;case d.Action:case d.Function:switch(f.f){case l.Name:t=0;r=null;if(f.d)D=0,m=f.v,x=!0;else{c=A(f.t==d.Action?w.acs:w.fds,f.v);if(!g(c))throw Error("CL11");
m=0<c.ps.length?c.n+"&nbsp;(":c.n;D=c.ps.length;f.t==d.Function&&(c.rt.o==h.Enum?r=db(c.rt.e):c.rt.o==h.Numeric&&g(c.rt.mds)?r=Za(c.rt.mds):c.rt.o==h.Date?Ba=c.rt.f:c.rt.o==h.Time&&(u=c.rt.f))}break;case l.Param:if(f.i==p.Field)c=A(w.fds,f.v),g(c)?m=c.n:(m=f.v,x=!0);else if(f.o==h.String)m='"'+f.v+'"';else if(f.o==h.Numeric)c=Y(b),c.ps.length>=t&&g(c.ps[t].mds)?(m=Za(c.ps[t].mds),g(m)&&0<m.length?(f.i=p.Field,m=A(m,f.v),g(m)?m=m.Name:(m=f.v,x=!0)):(x=!0,m=f.v)):m="["+f.v+"]";else if(f.o==h.Date)m=
e.formatDate(new Date(f.v),g(f.r)?f.r:L.defaultFormat());else if(f.o==h.Time)m=e.formatDate(new Date("1/1/2010 "+f.v),g(f.r)?f.r:ka.defaultFormat());else if(f.o==h.Enum)m=A(db(f.e),f.v),g(m)?m=m.Name:(m=f.v,x=!0);else if(f.o==h.Bool)m=ub(f.v);else throw Error("CL22");t++;break;case l.Comma:m=",";break;case l.End:m=0<D?")":"&nbsp;";D=t=0;break;default:throw Error("CL36");}break;case d.Calculation:switch(f.c){case n.Function:switch(f.f){case l.Name:t=0;r=null;if(f.d)D=0,m=f.v,x=!0;else{c=A(w.fds,f.v);
if(!g(c))throw Error("CL11");m=0<c.ps.length?c.n+"&nbsp;(":c.n;D=c.ps.length;if(c.rt.o!=h.Numeric)throw Error("CL13");g(c.rt.mds)&&(r=Za(c.rt.mds))}break;case l.Param:if(f.i==p.Field)c=A(w.fds,f.v),g(c)?m=c.n:(m=f.v,x=!0);else if(f.o==h.String)m='"'+f.v+'"';else if(f.o==h.Numeric)c=Y(b),c.ps.length>=t&&g(c.ps[t].mds)?(m=Za(c.ps[t].mds),g(m)&&0<m.length?(f.i=p.Field,m=A(m,f.v),g(m)?m=m.Name:(m=f.v,x=!0)):(x=!0,m=f.v)):m="["+f.v+"]";else if(f.o==h.Date)m=e.formatDate(new Date(f.v),g(f.r)?f.r:L.defaultFormat());
else if(f.o==h.Time)m=e.formatDate(new Date("1/1/2010 "+f.v),g(f.r)?f.r:ka.defaultFormat());else if(f.o==h.Enum)m=A(db(f.e),f.v),g(m)?m=m.Name:(m=f.v,x=!0);else if(f.o==h.Bool)m=ub(f.v);else throw Error("CL22");t++;break;case l.Comma:m=",";break;case l.End:m=0<D?")":"&nbsp;";D=t=0;break;default:throw Error("CL36");}break;case n.Field:c=A(w.fds,f.v);g(c)?m=c.n:(m=f.v,x=!0);break;case n.Number:m="["+f.v+"]";break;case n.LeftParenthesis:m=k.els.lbl.pb;break;case n.RightParenthesis:m=k.els.lbl.pe;break;
case n.Multiplication:m="&#215;";break;case n.Division:m="&#247;";break;case n.Addition:m="&#43;";break;case n.Subtraction:m="&#150;";break;default:throw Error("CL90");}break;case d.Field:f.d?(m=f.v,r=Ba=u=null,x=!0):(c=A(w.fds,f.v),g(c)?(r=f.o==h.Enum||f.o==h.Collection&&c.co==h.Enum?g(c.e)?db(c.e):c.ens:(f.o==h.Numeric||f.o==h.Collection&&c.co==h.Numeric)&&g(c.mds)?Za(c.mds):null,Ba=f.o==h.Date&&g(c.f)?c.f:null,u=f.o==h.Time&&g(c.f)?c.f:null,m=c.n):(m=f.v,r=Ba=u=null));break;case d.Exists:g(f.v)||
(f.v=f.y==y.DoesNotExist?"ce803":"ce802");m=ic(f.v);break;case d.Where:m=eb(k.els.dsc,"where");break;case d.Clause:m=A(k.els.cls,f.v);if(g(m))m=A(k.els.cls,f.v).n;else{alert("This rule cannot be properly loaded using the current Mode");return}break;case d.Setter:m=eb(k.els.str,f.v);break;case d.Operator:m=Oc(f.v,f.o);g(m)?m=m.n:(m="is",x=!0);break;case d.Value:f.o==h.Enum?g(r)&&0!=r.length?(c=A(r,f.v),g(c)?m=c.Name:(c=A(w.fds,f.v),g(c)?m=c.n:(m=f.v,x=!0))):(m="[Unknown]",x=!0):f.i==p.Field?(c=A(w.fds,
f.v),g(c)?m=c.n:(m=f.v,x=!0)):f.o==h.String?m='"'+f.v+'"':f.o==h.Numeric?g(r)&&0<r.length?(f.i=p.Field,m=A(r,f.v),g(m)?m=m.Name:(m=f.v,x=!0)):m="["+f.v+"]":m=f.o==h.Date?e.formatDate(new Date(f.v),g(Ba)?Ba:L.defaultFormat()):f.o==h.Time?e.formatDate(new Date("1/1/2010 "+f.v),g(u)?u:ka.defaultFormat()):ub(f.v)}I({t:f.t,id:ma,v:Oa(f.v),n:Oa(m),st:f.o,ct:f.c,co:f.co,cn:f.cn,ft:f.f,it:f.i,h:!0,fv:f.q});f.t!=d.LeftSource&&f.t!=d.RightSource||O(b);Ca(f.t,f.o,f.c,f.i)&&ra();x&&(b.className=b.className+" "+
X(k.warn),z=k.els.er.e107)}}r=tb=null;q=0;Eb();g(z)&&alert(z)}}else Zb=!0},ec=function(){if(g(k)){var a=$a.deserialize(sb);if(0!=a.length){a[0].e&&g(ha)&&(ha.setValue(k.els.er.e104),ha.setClass(X(k.nameCss)+" "+X(k.invalidColor)));for(var f=1;f<a.length;f++){var b=a[f],d=document.getElementById(b.c||b.ClientID);g(d)&&(d.className=d.className+" "+k.highlightBg,d.title=b.h||b.Hint,W.push(d.id))}k.help&&(1<a.length?(lb(k.els.er.e102),da.className=da.className+" "+X(k.invalidColor)):a[0].e&&(lb(k.els.er.e103),
da.className=da.className+" "+X(k.invalidColor)));sb=null}}else Yb=!0},gc=function(){jb||(Va=!1,xc.value=$a.serialize(Db()))},Db=function(){O(null);var a=Fa(),f,b,c,v,n=!1,q=new e.Models.RuleModel;q.Elements=[];g(ea)&&(q.Id=ea);q.IsLoadedRuleOfEvalType=k.isEval;q.Command=ab;q.Mode=k.mode;if(!Va){k.tools?(f=ha.getValue(),q.Name=0==e.trim(f).length||e.trim(f).toLowerCase()==k.els.lbl.n.toLowerCase()||e.trim(f).toLowerCase()==k.els.er.e104.toLowerCase()?null:Ya(f),f=la.getValue(),q.Desc=0==e.trim(f).length||
e.trim(f).toLowerCase()==k.els.lbl.d.toLowerCase()||e.trim(f).toLowerCase()==k.els.er.e104.toLowerCase()?null:Ya(f),q.SkipNameValidation=!1):q.SkipNameValidation=!0;for(var t=0;t<a.length;t++)if(v=a[t],b=x(v),g(b)&&b!=d.HtmlTag){f=new e.Client.Element;f.Type=b;f.Name=v.id;f.Oper=Z(v,!0);f.FuncType=N(v);f.InpType=ia(v);f.CalType=Q(v);switch(b){case d.Field:f.Value=v.getAttribute("ce208");f.IsRule="true"==v.getAttribute("ce213");b=A(w.fds,f.Value);n=g(b)&&g(b.mds);switch(f.Oper){case h.String:g(b)&&
(f.Max=b.max);break;case h.Numeric:g(b)&&(f.Dec=b.dec,f.Cal=b.cal,f.Min=b.min,f.Max=b.max,g(b.mds)&&(f.InpType=p.Input,n=!0));break;case h.Date:case h.Time:g(b)&&(f.Format=b.f);break;case h.Enum:g(b)&&(f.En=b.e);break;case h.Collection:if(g(b)&&(f.CollType=b.ct,b.ct==z.Value))switch(b.co){case h.String:f.Max=b.max;break;case h.Numeric:f.Dec=b.dec;f.Cal=b.cal;f.Min=b.min;f.Max=b.max;b.co==h.Numeric&&g(b.mds)&&(f.InpType=p.Input,n=!0);break;case h.Date:case h.Time:f.Format=b.f;break;case h.Enum:f.En=
b.e}}break;case d.LeftSource:O(v);f.Value=v.getAttribute("ce208");break;case d.RightSource:O(v);f.Value=v.getAttribute("ce208");break;case d.Value:f.Value=Ya(v.getAttribute("ce206"));f.Oper==h.Numeric&&n&&(b=A(w.fds,f.Value),g(b)||(f.InpType=p.Input));n=!1;break;case d.Calculation:g(v.getAttribute("ce206"))&&(f.Value=v.getAttribute("ce206"));break;case d.Action:case d.Function:if(b==d.Function&&f.FuncType==l.Name)f.Value=v.getAttribute("ce208"),f.IsFuncValue="true"==v.getAttribute("ce216"),b=A(w.fds,
f.Value),n=g(b)&&g(b.rt.mds);else if(f.FuncType==l.Param){var u=v;b=f.Oper;c=Y(u);var r=null;g(c)&&(u=fb(u),r=0<=u&&c.ps.length>=u&&c.ps[u].o==b?c.ps[u]:Pc(c,b,0>u?0:u));c=r;if(f.InpType==p.Input){if(g(c))switch(f.Oper){case h.String:f.Max=c.max;break;case h.Numeric:f.Dec=c.dec;f.Min=c.min;f.Max=c.max;break;case h.Date:case h.Time:f.Format=c.f;break;case h.Enum:f.En=c.e}g(v.getAttribute("ce206"))&&(f.Value=Ya(v.getAttribute("ce206")))}else f.Value=v.getAttribute("ce208"),b=A(w.fds,f.Value),g(c)&&
c.o==h.Numeric&&g(c.mds)&&!g(b)&&(f.InpType=p.Input)}else f.Value=v.getAttribute("ce208"),b==d.Function&&(f.IsFuncValue="true"==v.getAttribute("ce216"),A(w.fds,f.Value));break;case d.Exists:case d.Where:switch(v.getAttribute("ce208")){case "ce803":f.SelType=y.DoesNotExist;break;default:f.SelType=y.Exists}b=Ma(v,d.Field);g(b)?(b=A(w.fds,b.getAttribute("ce208")),g(b)?f.CollType=b.ct:f.CollType=z.Generic):f.CollType=z.Generic;f.Value=v.getAttribute("ce208");break;default:f.Value=v.getAttribute("ce208")}q.Elements.push(f)}}return q},
ud=function(a){function f(a){pa(a)?Ga(a):b=F(a)}function c(a){a=jc(b,l.End);g(a)&&(b=F(a),Pa())}function m(a,f){var c=Da(b),m=null;if(c&&(m=na(a.previousSibling),x(m)==d.Function)){var ma=mb(m,l.Name);if(!g(ma))return;m=na(ma.previousSibling)}ma=[];if(Q(b)==n.Function)for(c=Fb(f),G("ce801",h.Numeric,Qa(h.Numeric),ma),m=0;m<c.length;m++)ma.push(c[m]);else{var ma=Z(a,!0),m=!c||x(m)==d.Setter&&"to"==m.getAttribute("ce208"),e=A(w.fds,f),v,p,q,r,t,D,Ac;if(g(e)){e=e.t==d.Function?e.rt:e;v=e.o;r=e.co;p=
e.e;q=e.mds;t=e.cc;D=e.cl;Ac=e.cv;var y=[];if(g(e)&&"true"==b.getAttribute("ce216")){var C=e.t==d.Function?e.rt.ai:e.ai,E=e.t==d.Function?e.rt.o:e.o;(E==h.Numeric&&e.t==d.Function?e.rt.cal:e.cal)&&G("C",E,k.els.lbl.c,y);C==B.All&&G("ce801",E,Qa(E),y)}for(C=0;C<w.fds.length;C++)e=w.fds[C],e.ir&&c||e.ir&&(g(ea)&&e.v==ea||ma!=h.Bool)||e.v!=f&&(e.t==d.Function?m&&(e.rt.o!=ma||v==h.Enum&&p!=e.rt.e||e.mds!=q||y.push(e)):v==h.Collection&&e.o==h.Collection?e.ct==z.Reference&&e.cc==t&&e.cl==D&&e.cv==Ac?y.push(e):
e.ct!=z.Value||e.co!=r||r==h.Enum&&p!=e.e||e.mds!=q||y.push(e):e.o!=ma||v==h.Enum&&p!=e.e||e.mds!=q||y.push(e));ma=y}else ma=[]}0<ma.length?(P=!0,u(ma,a,Ba,null)):Da(b)||(ba=!1,c=A(w.fds,f),g(c)&&(c.t==d.Function?0<c.ps.length?(b=F(a),Ka(c)):nb(c):c.o==h.Collection&&c.ct!=z.Value||u(Ra(c),a,Na,null)))}function v(a,f){for(var d=[],c,m=0;m<w.acs.length;m++)c=w.acs[m],c.v!=f&&d.push(c);1<d.length||1==d.length&&d[0].v!=f?(P=!0,u(d,a,t,null)):(ba=!1,d=Gb(),0<d.length&&u(d,b,Hb,null))}function Ba(a,f){var m=
"true"==b.getAttribute("ce216"),g=Q(b)==n.Function;x(b)==d.Function||x(b)==d.Calculation&&N(b)==l.Name?c(a):J=!0;if("ce801"==a)switch(parseInt(f,10)){case h.Numeric:I({t:g?d.Calculation:d.Value,id:null,v:"",n:"[]",st:h.Numeric,ct:g?n.Number:n.None,ft:l.None,it:p.None,h:!1,fv:!1});break;default:vb(na(b))}else if("C"==a)kc(a);else{var e=A(w.fds,a);e.t==d.Function?ob({t:g?d.Calculation:e.t,m:a,v:m}):g?fa(n.Field,a):m?Qc(e,a,g):(Sa(e,null),!R()||Da(b)||e.o==h.Collection&&e.ct!=z.Value||u(Ra(e),b,Na,null))}}
function t(a){c(a);ob({t:A(w.acs,a).t,m:a,v:!1})}ba=!1;var D=a.target;g(C)&&(C.style.display="none");J=P=!1;if(g(e.getParentById(D,H.id))){O(b);bb();ra();qa=0;if(6==q||8==q)za.close(),q=Rc()?0:2;if(4==q)ka.hide(),q=0;else if(3==q)L.hide(),q=0;else if(2==q||1==q&&!g(b))Nc(),I({t:d.Flow,id:null,v:"if",n:k.isEval?k.evalIf:k.execIf,st:null,ct:null,ft:null,it:null,h:!1,fv:!1}),b=F(b),u(sa(),b,ta,d.LeftParenthesis);else{var r=!0;if(g(D.getAttribute("ce202")))Ca(x(D),Z(D,!0),Q(D),ia(D))&&ia(D)!=p.Field?
Sc(D):f(D);else{for(var r=!1,D=Fa(),y,E=!1,K=e.Client.browser==e.Client.type.IE&&9>e.Client.version?e.getScrollHeight():0,M=0;M<D.length;M++){if(!g(D[M].nextSibling)){f(D[M]);E=!0;break}y=wa(x(D[M].nextSibling)==d.HtmlTag?D[M].nextSibling.nextSibling:D[M].nextSibling);if(y.y>a.offsetY+K){f(D[M]);E=!0;break}}!E&&0<D.length&&f(D[D.length-1])}ba=k.clicks&&g(b)&&r&&!g(b.getAttribute("ce207"));O(b);S();q=0;if(ba){a=b.getAttribute("ce208");switch(x(b)){case d.Flow:"else"==a?u(Ha(),b,Ia,null):u(sa(),b,ta,
d.LeftParenthesis);break;case d.Function:switch(N(b)){case l.Param:a=Y(b);J=P=!0;Ka(a);break;case l.Name:m(b,a);break;case l.End:pa(b)&&m(b.previousSibling,a)}break;case d.Field:m(b,a);break;case d.LeftParenthesis:case d.LeftSource:u(sa(),b,ta,d.LeftParenthesis);break;case d.RightParenthesis:case d.RightBracket:case d.RightSource:u(V(),b,T,d.RightParenthesis);break;case d.Action:switch(N(b)){case l.Param:a=Y(b);J=P=!0;Ka(a);break;case l.Name:v(b,a);break;case l.End:pa(b)&&v(b.previousSibling,a)}break;
case d.Setter:"set"==a?u(wb(),b,xb,null):Ja(na(b));break;case d.LeftBracket:u(ua(),b,fa,null);break;case d.Calculation:r=[];switch(Q(b)){case n.LeftParenthesis:J=P=!1;u(ua(),b,fa,null);break;case n.RightParenthesis:J=P=!1;u(ua(),b,fa,null);break;case n.Function:switch(N(b)){case l.Name:m(b,a);break;case l.End:pa(b)&&m(b.previousSibling,a)}break;case n.Field:Tc(a);break;case n.Addition:G(n.Subtraction,null,"&#150;",r);G(n.Multiplication,null,"&#215;",r);G(n.Division,null,"&#247;",r);J=P=!0;u(r,b,fa,
null);break;case n.Subtraction:G(n.Addition,null,"&#43;",r);G(n.Multiplication,null,"&#215;",r);G(n.Division,null,"&#247;",r);J=P=!0;u(r,b,fa,null);break;case n.Multiplication:G(n.Addition,null,"&#43;",r);G(n.Subtraction,null,"&#150;",r);G(n.Division,null,"&#247;",r);J=P=!0;u(r,b,fa,null);break;case n.Division:G(n.Addition,null,"&#43;",r),G(n.Subtraction,null,"&#150;",r),G(n.Multiplication,null,"&#215;",r),J=P=!0,u(r,b,fa,null)}break;case d.Operator:r=Aa(b);g(r)&&(r=A(w.fds,r.getAttribute("ce208")),
g(r)&&(r=Ra(r,a),g(r)&&0<r.length?(J=P=!0,u(r,b,Na,null)):(ba=!1,"isNull"==a||"isNotNull"==a?u(V(),b,T,d.RightParenthesis):Ja(na(b)))));break;case d.Clause:"then"==a?u(Ha(),b,Ia,null):Da(b)?u(Ha(),b,Ia,null):(a=sd(a),g(a)&&0<a.length?(J=P=!0,u(a,b,T,null)):u(sa(),b,ta,d.LeftParenthesis));break;case d.Exists:r=[];switch(a){case "ce803":G("ce802",d.Field,k.els.lbl.h,r);break;default:G("ce803",d.Field,k.els.lbl.l,r)}J=P=!0;u(r,b,td,null);break;case d.Value:Q(b)==n.Function?Tc(a):(a=Z(b,!0),J=a!=h.Date&&
a!=h.Time,P=!0,Ja(na(b)))}kb()}}}else 8==q?(O(b),D.id!=ya.id&&(za.close(),q=1)):(a=L.getId(),3==q&&null!=a&&g(e.getParentById(D,a))||Eb());return!0},vd=function(a){ja=!0;J=P=ba=!1;if(1==q||2==q)return O(),!0;O(b);var f=a.keyCode;if(16==f)return!0;if(127==f||27==f||8==f)ja=!1;32==f&&0<t.length&&(t+=" ");6!=q&&8!=q||40!=f||Vb++;if((6==q||8==q)&&37!=f&&39!=f&&(38!=f||0<Vb))return!0;if(4==q||3==q){if(13==f)return!0;4==q?ka.hide():L.hide();q=0}var c=x(b),m=Z(b,!0);switch(f){case 9:t="";c!=d.NewLine&&c!=
d.Tab||I({t:d.Tab,id:null,v:"",n:"&nbsp;",st:null,ct:n.None,ft:null,it:null,h:!1,fv:!1});ja=!1;break;case 13:if(!Ea||Ea&&yb)if(t="",c==d.Value)m!=h.String&&m!=h.Numeric||!g(b.getAttribute("ce207"))?cb(!1):(ra(),b=F(b),S(),R()&&u(V(),b,T,d.RightParenthesis));else if(c==d.Calculation&&Q(b)==n.Number)g(b.getAttribute("ce207"))?(ra(),b=F(b),S(),R()&&u(ua(),b,fa,null)):cb(!1);else if(c==d.Function||c==d.Action)m!=h.String&&m!=h.Numeric||!g(b.getAttribute("ce207"))?pa(b)?(Ga(b),cb(!1)):N(b)==l.End&&cb(!1):
(ra(),b=F(b),S(),Ka(Y(b)));else if(Ib(b)){if(g(b.nextSibling)&&N(b.nextSibling)==l.End&&0==Y(b).ps.length){var e=Jb(b);g(e)&&(b=e)}cb(!1)}yb||(yb=!0);ja=!1;break;case 34:qa=0;ra();e=Fa();b=F(e[e.length-1]);e=wa(b);lc(e.y,e.height);pa(b)&&Ga(b);O(b);S();ja=!1;break;case 35:qa=0;ra();e=Ma(b,d.HtmlTag);g(e)?b=F(e.previousSibling):(e=Fa(),b=F(e[e.length-1]));pa(b)&&Ga(b);O(b);S();ja=!1;break;case 33:qa=0;ra();b=F(Fa()[0]);O(b);Kb(wa(b).y);S();ja=!1;break;case 36:qa=0;ra();e=mc(b,d.NewLine);if(!g(e)&&
(e=Fa()[0],"if"!=e.getAttribute("ce208")))throw Error("CL02");b=F(e);O(b);S();ja=!1;break;case 38:6!=q&&8!=q||xa();Ca(c,m,Q(b),ia(b))&&g(b.getAttribute("ce207"))&&(ra(),b=F(b));var c=Fa(),m=wa(b),k=null,r,D;0==qa&&(qa=m.x+m.width);for(var y=!1,B=c.length-1;-1<B;B--)if(y){D=c[B];r=x(D);if(g(k)&&(r==d.NewLine||pb(D))){b=F(D);Kb(e.y);break}e=wa(D);if(!(e.y>m.y-parseInt(e.height/2,10)))if(g(k)||(k=D),qa>e.x+e.width||!g(D.previousSibling)||wa(D.previousSibling).y<e.y){b=F(D);Kb(e.y);break}else if(r=e.x+
parseInt(e.width/2,10),qa>r){Kb(e.y);b=F(D);break}}else y=c[B].id==b.id;pa(b)&&Ga(b);O(b);S();ja=!1;break;case 40:Ca(c,m,Q(b),ia(b))&&g(b.getAttribute("ce207"))&&(ra(),b=F(b));e=Fa();c=wa(b);0==qa&&(qa=c.x+c.width);D=!1;for(y=e.length-1;-1<y;y--){k=e[y];if(k.id==b.id)break;m=wa(k);D||(D=m.y-c.height-parseInt(c.height/2,10)<c.y);if(D)if(B=wa(k.previousSibling),qa>m.x+m.width||!g(B)||B.y<m.y){b=F(k);lc(m.y,m.height);break}else if(B=m.x+parseInt(m.width/2,10),qa>=B){b=F(k);lc(m.y,m.height);break}}pa(b)&&
Ga(b);O(b);S();ja=!1;break;case 37:qa=0;6!=q&&8!=q||xa();Ca(c,m,Q(b),ia(b))&&ia(b)!=p.Field?(g(b.getAttribute("ce207"))?(ra(),b=F(b.previousSibling),pa(b)&&Ga(b)):b.setAttribute("ce207","true"),S()):g(b.previousSibling)&&(e=x(b.previousSibling),b=F(e==d.HtmlTag?b.previousSibling.previousSibling:b.previousSibling),O(b),pa(b)&&(N(b)==l.End?Ga(b):b=F(b.previousSibling)),O(b),S());ja=!1;break;case 39:qa=0;6!=q&&8!=q||xa();if(c!=d.Value||m!=h.String&&m!=h.Numeric||!g(b.getAttribute("ce207")))if(c==d.Calculation&&
Q(b)==n.Number&&g(b.getAttribute("ce207")))ra(),b=F(b),S(),R()&&u(ua(),b,fa,null);else if(c!=d.Function&&c!=d.Action||ia(b)!=p.Input||m!=h.String&&m!=h.Numeric||!g(b.getAttribute("ce207")))if(g(b.nextSibling)&&pa(b.nextSibling))Ga(b.nextSibling),O(b),S(),nb(Y(b));else{if(e=!1,g(b.nextSibling)&&(b=x(b.nextSibling)==d.HtmlTag?F(b.nextSibling.nextSibling):F(b.nextSibling),O(b),e=!0),e){c=x(b);e=R();if(Ca(c,Z(b,!0),Q(b),ia(b))&&ia(b)!=p.Field)b.setAttribute("ce207","true"),S();else if(g(b.nextSibling)||
c!=d.RightBracket)if(c!=d.Function&&c!=d.Action||!e)c==d.Flow&&e?"else"==b.getAttribute("ce208")?u(Ha(),b,Ia,null):u(sa(),b,ta,d.LeftParenthesis):c!=d.LeftParenthesis&&c!=d.LeftSource||!e?c!=d.RightParenthesis&&c!=d.RightSource&&c!=d.RightBracket&&c!=d.Value||!e?c==d.Field&&e?Da(b)||(e=b.getAttribute("ce208"),A(w.fds,e).ct!=z.Reference&&u(Ra(A(w.fds,e)),b,Na,null)):c==d.Exists&&e?u(nc(Ma(b,d.Field).getAttribute("ce208")),b,oc,null):c==d.Setter&&e?"set"==b.getAttribute("ce208")?u(wb(),b,xb,null):Ja(na(b)):
c==d.Operator&&e?"isNull"==b.getAttribute("ce208")||"isNotNull"==b.getAttribute("ce208")?u(V(),b,T,d.RightParenthesis):Ja(b,!0):c==d.Clause&&e?"then"==b.getAttribute("ce208")||Da(b)?u(Ha(),b,Ia,null):u(sa(),b,ta,d.LeftParenthesis):c!=d.LeftBracket&&c!=d.Calculation||!e||u(ua(),b,fa,null):u(V(),b,T,d.RightParenthesis):(c==d.LeftSource&&O(b),u(sa(),b,ta,d.LeftParenthesis));else switch(N(b)){case l.End:nb(Y(b));break;case l.Name:e=Y(b),0<e.ps.length&&N(b.nextSibling)==l.End&&Ka(e)}else u(V(),b,T,d.RightParenthesis);
kb()}}else ra(),b=F(b),S();else ra(),b=F(b),S(),R()&&u(V(),b,T,d.RightParenthesis);ja=!1}if(rb)return 8==f&&a.preventDefault(),!1;if(Ea&&13==f||8==f||9==f||33==f||34==f||35==f||36==f||38==f||39==f||40==f)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation();return ja},wd=function(a){var f=a.keyCode;if(!ja)return ja=!0,rb?(9!=f&&13!=f&&33!=f&&34!=f&&35!=f&&36!=f&&38!=f&&40!=f||a.preventDefault(),!1):!0;if(1==q||2==q)return!0;if((6==q||8==q)&&!oa(f)||(6==q||8==q)&&38==f)return!1;
if(3!=q&&4!=q){Ea||a.preventDefault();var c=t;t="";if(8==q)32==f?(P=!0,u(K,ya,Lb,null),q=8):oa(f)&&(t=c+=String.fromCharCode(f),P=!0,aa(K,ya,Lb,null),q=8);else{var m=na(b);switch(x(m)){case d.Flow:"else"==m.getAttribute("ce208")?32==f?u(Ha(),b,Ia,null):oa(f)&&(t=c+=String.fromCharCode(f),aa(Ha(),b,Ia,null)):32==f?u(sa(),b,ta,d.LeftParenthesis):oa(f)&&(t=c+=String.fromCharCode(f),aa(sa(),b,ta,d.LeftParenthesis));break;case d.Function:case d.Action:if(pc(f))switch(N(m)){case l.End:if(32==f)nb(Y(m));
else if(oa(f)&&(c=Y(m),R()&&(m=c.t==d.Function?Ra(c):Gb(),0<m.length))){var c=c.t==d.Function?Na:Hb,e=Uc(m,t);0<e.length?u(e,b,c,null,!0):u(m,b,c,null,!1)}break;default:if(e=Z(m,!0),Ca(x(m),e,Q(m),ia(m))&&(e==h.String||e==h.Numeric&&(43<f&&47>f||47<f&&58>f))&&g(m.getAttribute("ce207"))){var c=fb(m),c=0>c?0:c,Ba=Y(m);Mb(m,f,e,Ba.ps[c].max,g(Ba.ps[c].min)?Ba.ps[c].min:null,Ba.ps[c].dec)}else 32==f?Ka(Y(m)):oa(f)&&(t=c+=String.fromCharCode(f),Ka(Y(m)))}break;case d.LeftParenthesis:case d.LeftSource:32==
f?u(sa(),b,ta,d.LeftParenthesis):oa(f)&&(t=c+=String.fromCharCode(f),aa(sa(),b,ta,d.LeftParenthesis));break;case d.RightSource:O(b);32==f?u(V(),b,T,d.RightParenthesis):oa(f)&&(t=c+=String.fromCharCode(f),aa(V(),b,T,d.RightParenthesis));break;case d.RightParenthesis:case d.RightBracket:32==f?u(V(),b,T,d.RightParenthesis):oa(f)&&(t=c+=String.fromCharCode(f),aa(V(),b,T,d.RightParenthesis));break;case d.Exists:32==f?u(nc(Ma(b,d.Field).getAttribute("ce208")),b,oc,null):oa(f)&&(t=c+=String.fromCharCode(f),
aa(nc(Ma(b,d.Field).getAttribute("ce208")),b,oc,null));break;case d.Field:if(32==f&&Da(m)){c=g(m.nextSibling)?Jb(m.nextSibling):null;c&&x(c)==d.Setter&&"to"==c.getAttribute("ce208")||(c=A(w.fds,m.getAttribute("ce208")),g(c)&&(I({t:d.Setter,id:null,v:"to",n:eb(k.els.str,"to"),st:c.o,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1}),R()&&Ja(na(m))));break}m=A(w.fds,m.getAttribute("ce208"));m.ct!=z.Reference&&(m=Ra(m),32==f?u(m,b,Na,null):oa(f)&&(t=c+=String.fromCharCode(f),aa(m,b,Na,null)));break;case d.Operator:32==
f?"isNull"==m.getAttribute("ce208")||"isNotNull"==m.getAttribute("ce208")?u(V(),m,T,d.RightParenthesis):Ja(m):oa(f)&&(t=c+=String.fromCharCode(f),"isNull"==m.getAttribute("ce208")||"isNotNull"==m.getAttribute("ce208")?aa(V(),b,T,d.RightParenthesis):g(r)&&0<r.length?aa(r,b,qc,null):g(E.ce)&&0<E.ce.length||0<E.length?aa(E,b,Ub?Vc:Wc,null):Ja(m));break;case d.Clause:32==f?"then"==m.getAttribute("ce208")||Da(m)?u(Ha(),b,Ia,null):u(sa(),b,ta,d.LeftParenthesis):oa(f)&&(m="then"==m.getAttribute("ce208")||
Da(m),t=c+=String.fromCharCode(f),aa(m?Ha():sa(),b,m?Ia:ta,m?null:d.LeftParenthesis));break;case d.LeftBracket:32==f?u(ua(),b,fa,null):oa(f)&&(t=c+=String.fromCharCode(f),aa(ua(),b,fa,null));break;case d.Calculation:if(Q(m)==n.Number){if(pc(f))if(43<f&&47>f||47<f&&58>f){if(g(m.getAttribute("ce207"))&&(c=Wa(m),c=3>c.length?"":c.substr(1,c.length-2),28>c.length&&(45!=f||1>c.length))){if(44==f||46==f)c=c.replace(/[\.,]+/g,"");c+=String.fromCharCode(f);if(","==c||"."==c)c="0"+c;if("-,"==c||"-."==c)c=
"-0"+c.substr(1,1);1<c.length&&"0"==c.substr(0,1)&&","!=c.substr(1,1)&&"."!=c.substr(1,1)&&(c=c.substr(1));2<c.length&&"-0"==c.substr(0,2)&&","!=c.substr(2,1)&&"."!=c.substr(2,1)&&(c="-"+c.substr(2));Wa(m,"["+c+"]");m.setAttribute("ce206",c);b=m;S()}}else 32==f?u(ua(),b,fa,null):oa(f)&&(t=c+=String.fromCharCode(f),aa(ua(),b,fa,null))}else 32==f?u(ua(),b,fa,null):oa(f)&&(t=c+=String.fromCharCode(f),aa(ua(),b,fa,null));break;case d.Setter:32==f?"set"==m.getAttribute("ce208")?u(wb(),b,xb,null):Ja(m):
oa(f)&&(t=c+=String.fromCharCode(f),"set"==m.getAttribute("ce208")?aa(wb(),b,xb,null):g(r)&&0<r.length?aa(r,b,qc,null):Ja(m));break;case d.Value:if(pc(f))if(e=Z(m),e==h.String||e==h.Numeric&&(43<f&&47>f||47<f&&58>f))g(m.getAttribute("ce207"))?(c=Aa(m),c=g(c)?A(w.fds,c.getAttribute("ce208")):null,g(c)?c.t==d.Function?Mb(m,f,e,c.rt.max,g(c.rt.min)?c.rt.min:null,c.rt.dec):Mb(m,f,e,c.max,g(c.min)?c.min:null,c.dec):Mb(m,f,e,null,null,null)):32==f?u(V(),b,T,d.RightParenthesis):oa(f)&&(t=c+=String.fromCharCode(f),
aa(V(),b,T,d.RightParenthesis));else if(e==h.Numeric&&32==f)g(m.getAttribute("ce207"))||u(V(),b,T,d.RightParenthesis);else if(e==h.Date||e==h.Time||e==h.Bool||e==h.Enum)32==f?u(V(),b,T,d.RightParenthesis):oa(f)&&(t=c+=String.fromCharCode(f),aa(V(),b,T,d.RightParenthesis))}}}if(rb)return 8!=f&&9!=f&&32!=f&&33!=f&&34!=f&&35!=f&&36!=f&&38!=f&&40!=f||a.preventDefault(),!1;if(8==f||9==f||32==f)a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()},Eb=function(){bb();6==q?(za.close(),
q=1):3==q?(L.hide(),q=1):4==q?(ka.hide(),q=1):0==q&&(q=1,g(b)&&g(b.getAttribute("ce207"))&&ra());Rc()||Xc();2!=q&&k.help&&lb(k.els.ms.i102);fc();t="";if(g(b)&&(b.className=b.className.replace(" "+k.currentBg,""),pa(b))){var a=mb(b,l.Name);g(a)&&(a.className=a.className.replace(" "+k.currentBg,""))}O(null)},ob=function(a){var f=A(a.t==d.Action?w.acs:w.fds,a.m);I({t:a.t==d.Calculation?a.t:f.t,id:null,v:f.v,n:0<f.ps.length?f.n+"&nbsp;(":f.n,st:f.t==d.Action?null:f.rt.o,ct:a.t==d.Calculation?n.Function:
n.None,ft:l.Name,it:p.None,h:!1,fv:a.v});var c=b;I({t:a.t==d.Calculation?a.t:f.t,id:null,v:f.v,n:0<f.ps.length?")":"&nbsp;",st:f.t==d.Action?null:f.rt.o,ct:a.t==d.Calculation?n.Function:n.None,ft:l.End,it:p.None,h:!1,fv:a.v});0<f.ps.length?(b=F(c),R()&&Ka(f)):R()&&nb(f)},Ka=function(a){var f=fb(b);if(f>=a.ps.length-1&&!J){var c=jc(b,l.End);g(c)&&(b=F(c),nb(a))}else{f+=1;J&&--f;a=a.ps[f];var c=[],m;r=null;switch(a.ai){case B.All:case B.Fields:if(a.o==h.Collection){for(var e=0;e<w.fds.length;e++)m=
w.fds[e],ba&&b.getAttribute("ce208")==m.v||m.t==d.Field&&m.o==h.Collection&&(a.ct==z.Generic?m.cg&&G(m.v,a.o,m.n,c):m.ct==a.ct&&m.cr==a.cr&&m.cg==a.cg&&m.cv==a.cv&&m.cl==a.cl&&G(m.v,a.o,m.n,c));0<t.length?aa(c,b,Ta,null):u(c,b,Ta,null)}else{a:{var e=a.o,k=f,f=[],n=Aa(b);if(g(n)){m=A(w.fds,n.getAttribute("ce208"));g(m)||(m=A(w.acs,n.getAttribute("ce208")));if(!g(m)){e=f;break a}m=m.ps[k]}if(g(m))for(n=0;n<w.fds.length;n++)if(k=w.fds[n],k.t==d.Field&&!k.ir&&k.o==e){if(m.o==h.Numeric){if(m.l!=k.l||k.min<
m.min||k.max>m.max||k.dec!=m.dec||k.mds!=m.mds)continue}else if(m.o==h.Enum){if(m.e!=k.e||m.l!=k.l)continue}else if(m.l!=k.l)continue;f.push(k)}e=f}if(0<e.length){a.ai==B.All&&G("ce801",g(a.mds)?a.mds:a.o,Qa(a.o,g(a.mds)),c);for(f=0;f<e.length;f++)m=e[f],ba&&b.getAttribute("ce208")==m.v||G(m.v,a.o,m.n,c);0<t.length?aa(c,b,Ta,null):u(c,b,Ta,null)}else g(a.mds)?rc(a.mds):Ta("ce801",a.o)}break;case B.User:g(a.mds)?rc(a.mds):Ta("ce801",a.o);break;default:throw Error("CL58");}}},rc=function(a){r=Za(a);
var f=[];if(null!=r&&0<r.length){for(var d=0;d<r.length;d++)G(r[d].ID,a,r[d].Name,f);0<t.length?aa(f,b,Ta,null):u(f,b,Ta,null)}else Ta("ce801",h.Numeric)},Ta=function(a,f){function d(a,f){var c;J?(c=b,J=!1):c=N(b)==l.Name?b:b.nextSibling;c=gb(c,f);g(c)?ga(c):sc(a)}function c(a){var f=null,d=a?h.Date:h.Time;a=a?"":"1/1/2000 ";try{var m=b;if(N(m)!=l.Param||Z(m)!=d)m=gb(m,d);g(m)&&(f=new Date(a+m.getAttribute("ce206")));isNaN(f.getDate())&&(f=null);return f}catch(e){return null}}var e=Y(b);if("ce801"==
a){var k=Yc(f);if(g(k))P=J,rc(k.Name);else switch(parseInt(f,10)){case h.Numeric:P=!1;Nb(gb(g(b.nextSibling)?b.nextSibling:b,h.Numeric))&&(d(e,h.Numeric),I({t:e.t,id:null,v:"",n:"[]",st:h.Numeric,ct:n.None,ft:l.Param,it:p.Input,h:!1,fv:!1}));break;case h.String:P=!1;Nb(gb(g(b.nextSibling)?b.nextSibling:b,h.String))&&(d(e,h.String),I({t:e.t,id:null,v:"",n:'""',st:h.String,ct:n.None,ft:l.Param,it:p.Input,h:!1,fv:!1}));break;case h.Date:za.close();q=3;L.show(b,xd,tc(e,L.defaultFormat()),J,c(!0));L.position();
break;case h.Time:za.close();q=4;ka.show(b,yd,tc(e,ka.defaultFormat()),J,c(!1));ka.position();break;case h.Enum:k=fb(b)+(J?0:1);0>k&&(k=0);k<=e.ps.length-1&&(r=db(e.ps[k].e),P=J);u(r,b,zd,null);break;case h.Bool:P=J;u(Zc(),b,Ad,null);break;case h.Collection:break;default:throw Error("CL62");}}else k=Za(f),g(k)?(d(e,h.Numeric),I({t:e.t,id:null,v:a,n:A(k,a).Name,st:h.Numeric,ct:n.None,ft:l.Param,it:p.Field,h:!1,fv:!1})):(k=A(w.fds,a),d(e,parseInt(f,10)),I({t:e.t,id:null,v:k.v,n:k.n,st:k.o,ct:n.None,
ft:l.Param,it:p.Field,h:!1,fv:!1})),r=null,b=F(b),R()&&Ka(e)},Ad=function(a){$c(a,h.Bool,ub(a))},zd=function(a){$c(a,h.Enum,A(r,a).Name)},$c=function(a,f,d){var c=gb(J?b:b.nextSibling,f),e=!1;g(c)&&(za.close(),ga(c),e=!0,J=!1);c=Y(b);e||sc(c);I({t:c.t,id:null,v:a,n:d,st:f,ct:n.None,ft:l.Param,it:p.Input,h:!1,fv:!1});b.setAttribute("ce206",a);b=F(b);R()&&Ka(c)},xd=function(a){var f=Y(b);ad(a,f,h.Date,e.formatDate(new Date(a),tc(f,L.defaultFormat())),L)},yd=function(a,f){ad(a,Y(b),h.Time,f,ka)},ad=
function(a,f,c,m,e){var k=gb(J?b:b.nextSibling,c),h=!1;g(k)&&(ga(k),h=!0,J=!1);I({t:f.t,id:null,v:a,n:m,st:c,ct:n.None,ft:l.Param,it:p.Input,h:!1,fv:!1});b=F(b);e.hide();q=0;if(!h)switch(a=hb(b.nextSibling),N(a)){case l.Param:a=b;I({t:f.t,id:null,v:"",n:",",st:f.t==d.Action?null:f.rt.o,ct:n.None,ft:l.Comma,it:p.None,h:!1,fv:!1});b=F(a);break;case l.End:case l.Comma:a=b,c=na(b.previousSibling),N(c)==l.Param&&1<Y(b).ps.length&&(b=c,I({t:f.t,id:null,v:"",n:",",st:f.t==d.Action?null:f.rt.o,ct:n.None,
ft:l.Comma,it:p.None,h:!1,fv:!1}),b=F(a))}P=!1;S();R()&&Ka(f)},sc=function(a){var f=hb(b.nextSibling),c;switch(N(f)){case l.Comma:b=f;sc(a);break;case l.Param:I({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:n.None,ft:l.Comma,it:p.None,h:!1,fv:!1});b=F(b.previousSibling);break;case l.End:f=N(b)!=l.None?null:b,c=na(b),N(c)==l.Param&&1<Y(b).ps.length&&(b=F(c),I({t:a.t,id:null,v:"",n:",",st:a.t==d.Action?null:a.rt.o,ct:n.None,ft:l.Comma,it:p.None,h:!1,fv:!1}),g(f)&&(b=F(f)))}},fb=function(a){for(var b=
-1;g(a)&&N(a)!=l.Name;)N(a)==l.Param&&b++,a=a.previousSibling;return b},nb=function(a){if(g(a)&&R())if(x(b)==d.Calculation&&N(b)==l.End)u(ua(),b,fa,null);else if(a.t==d.Function){var f=mb(b,l.Name);g(f)?"true"==f.getAttribute("ce216")?u(V(),b,T,d.RightParenthesis):u(Ra(a),b,Na,null):u(Ra(a),b,Na,null)}else a=Gb(),0<a.length&&u(a,b,Hb,null)},Y=function(a){a=mb(a,l.Name);return g(a)?A(x(a)==d.Action?w.acs:w.fds,a.getAttribute("ce208")):null},Hc=function(a,b){for(var c,d,k=0;k<a.length;k++)if(c=a[k],
!g(c.Client)||!c.Client){d=new e.StringBuilder;b?g(c.Ns)&&0<c.Ns.length&&(CodeEffects.register(c.Ns),d.append(c.Ns),d.append(".")):d.append("CodeEffects.Rule.");d.append(bd(c.Name));g(eval(d.dump()))?d.append(".ce = ["):d.append(" = [");if(!g(c.Data)||!c.Data.length)throw Error("CL39");for(var h=0;h<c.Data.length;h++)0<h&&d.append(","),d.append('{"ID":"'),d.append(c.Data[h].ID),d.append('","Name":"'),d.append(c.Data[h].Name),d.append('"}');d.append("]");eval(d.dump())}},pc=function(a){switch(a){case 8:case 9:case 16:case 17:case 18:case 19:case 20:case 27:case 127:return!1;
default:return!0}},Mb=function(a,f,c,d,e,l){var n=Wa(a),n=3>n.length?"":n.substr(1,n.length-2),p=g(d)?d:256,q=g(l)?l:!0,r=g(e)?0>e:!0;if(c==h.String&&n.length<p){var t;if(22==f)if(Ea)try{t=window.clipboardData.getData("Text").replace(/[\s]+/g," "),n.length+t.length>p&&(t=t.substr(0,p-n.length))}catch(u){}else k.help&&g(k.els.er.e101)&&alert(k.els.er.e101);else t=String.fromCharCode(f),0==n.length&&(t=t.replace(/[\s]+/g,""));d=n+t;Wa(a,'"'+d+'"');a.setAttribute("ce206",d)}else if(c==h.Numeric&&28>
n.length&&(q||44!=f&&46!=f)&&(r&&1>n.length||45!=f)){!l||44!=f&&46!=f||(n=n.replace(/[\.,]+/g,""));f=n+String.fromCharCode(f);if(","==f||"."==f)f="0"+f;if("-,"==f||"-."==f)f="-0"+f.substr(1,1);1<f.length&&"0"==f.substr(0,1)&&","!=f.substr(1,1)&&"."!=f.substr(1,1)&&(f=f.substr(1));2<f.length&&"-0"==f.substr(0,2)&&","!=f.substr(2,1)&&"."!=f.substr(2,1)&&(f="-"+f.substr(2));c=parseFloat(f.replace(",","."));e=g(e)?e:-9007199254740992;d=g(d)?d:9007199254740992;c>d&&(0<=d?f=d+"":(parseInt(c,10)+"").length>=
(parseInt(e,10)+"").length&&(f=d+""));Wa(a,"["+f+"]");a.setAttribute("ce206",f);a.setAttribute("ce212",d.toString());a.setAttribute("ce211",e.toString())}b=a;S()},u=function(a,f,c,m,h){var l,n;g(a.ce)&&(a=a.ce);za.close();var p=[];if(g(m)){a:{n=!0;x(b)!=d.RightSource||g(b.nextSibling)||(n=!1);l=Ma(g(b.nextSibling)?b.nextSibling:b,d.RightSource);g(l)?n&&(l=l.previousSibling):(l=Ma(b,d.Flow),g(l)?l=l.previousSibling:(l=Fa(),l=l[l.length-1]));var r=0;n=0;for(var u;g(l);){u=x(l);if(u==d.RightSource){l=
uc(l,d.LeftSource);if(g(l)&&g(l.previousSibling))l=l.previousSibling;else{n=l=0;break a}u=x(l)}if(u==d.Flow||u==d.LeftSource)break;u==d.LeftParenthesis&&r++;u==d.RightParenthesis&&n++;l=g(l.previousSibling)&&x(l.previousSibling)!=d.Flow?l.previousSibling:null}l=r}if(m==d.RightParenthesis&&l>n){if(m=new e.Menu.Item,m.Name=k.els.lbl.pe,m.Type=d.RightParenthesis,p.push(m),a[0].t==d.Clause){m=[];for(l=0;l<a.length;l++)"then"!=a[l].v&&m.push(a[l]);a=m}}else m==d.LeftParenthesis&&(m=new e.Menu.Item,m.Name=
k.els.lbl.pb,m.Type=d.LeftParenthesis,p.push(m))}for(n=0;n<a.length;n++){l=a[n];m=new e.Menu.Item;m.ID=l.v||l.ID;m.Name=l.n||l.Name;if(g(l.t)||g(l.Type))m.Type=l.t||l.Type;p.push(m)}za.fill(f,p,c,Ea&&9>e.Client.version?Bd:null,Cd,k.help?Dd:null);P&&za.alignLeft(f);P=!1;q=6;h||(t="")},aa=function(a,b,c,d){a=Uc(a,t);if(0<a.length){var e=t;u(a,b,c,d,!0);za.select(e)}else xa()},Ja=function(a,f){function c(b,f){if("ce801"==b)switch(parseInt(f,10)){case h.Numeric:I({t:d.Value,id:null,v:"",n:"[]",st:h.Numeric,
ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1});break;default:vb(na(a))}else if("C"==b)kc(b);else{var e=A(w.fds,b);e.t==d.Function?ob({t:e.t,m:b,v:!0}):Qc(e,b,!1)}}function e(a){if("ce801"==a){a=q();var b=null;a.t==d.Function?g(a.rt.mds)&&(b=a.rt.mds):g(a.mds)&&(b=a.mds);v(b)}else c(a)}function v(a){r=Za(a);null!=r&&(P=J,u(r,b,qc,null))}function q(){var a=Aa(b);return g(a)?A(w.fds,a.getAttribute("ce208")):null}function x(a,f,c,e){for(var m=0;m<a.length;m++){var g=a[m];g.t!=d.Function&&g.v==c.v||G(g.v,
g.o,g.n,f)}0<t.length?aa(f,b,e,null):u(f,b,e,null)}var D=q();if(g(D)){var y=D.t==d.Function?D.rt.ai:D.ai,z=cd(D),C=null;D.t==d.Function?g(D.rt.mds)&&(C=D.rt.mds):g(D.mds)&&(C=D.mds);if(g(C)){var E=dd(z,D);if(y==B.User||0==E.length||1==E.length&&E[0].v==D.v)v(C);else{var F=[];0<E.length?(y==B.All&&G("ce801",z,Qa(z,!0),F),x(E,F,D,e)):v(C)}}else y==B.User?f&&z!=h.Enum&&z!=h.Bool||vb(a):(C=[],E=dd(z,D),0<E.length?1==E.length&&D.t!=d.Function&&E[0].v==D.v?vb(a):((z==h.Numeric&&D.t==d.Function?D.rt.cal:
D.cal)&&G("C",z,k.els.lbl.c,C),y==B.All&&G("ce801",z,Qa(z),C),x(E,C,D,c)):f||vb(a))}},Qc=function(a,f,c){I({t:c?d.Calculation:d.Value,id:null,v:a.v,n:a.n,st:a.o,ct:c?n.Field:n.None,ft:l.None,it:p.Field,h:!1,fv:!1});b.setAttribute("ce206",f);R()&&(c?u(ua(),b,fa,null):u(V(),b,T,d.RightParenthesis))},vb=function(a){function f(a){var f=null;try{var c=b;a=a?"":"1/1/2000 ";x(c)!=d.Value&&(c=Ma(c,d.Value));g(c)&&(f=new Date(a+c.getAttribute("ce206")));isNaN(f.getDate())&&(f=null)}catch(e){f=null}return f}
xa();switch(Z(a)){case h.String:Nb(b.nextSibling)&&I({t:d.Value,id:null,v:"",n:'""',st:h.String,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1});break;case h.Date:q=3;a=Aa(b);a=g(a)?A(w.fds,a.getAttribute("ce208")):null;a=g(a)?g(a.rt)?a.rt.f:a.f:L.defaultFormat();L.show(b,Ed,a,J,f(!0));L.position();break;case h.Time:q=4;a=Aa(b);a=g(a)?A(w.fds,a.getAttribute("ce208")):null;a=g(a)?g(a.rt)?a.rt.f:a.f:ka.defaultFormat();ka.show(b,Fd,a,J,f(!1));ka.position();break;case h.Enum:a=Aa(a);g(a)&&(x(a)==d.Function?
(a=Y(a),r=db(a.rt.e)):(a=A(w.fds,a.getAttribute("ce208")),r=g(a.e)?db(a.e):a.ens),E=r,Ub=!1,P=J,u(r,b,Wc,null));break;case h.Bool:E=Zc();Ub=!0;P=J;u(E,b,Vc,null);break;default:a=Aa(b),a=g(a)?A(w.fds,a.getAttribute("ce208")):null,g(a)&&(a.cal||g(a.rt)&&a.rt.cal)?(a=[],G("C",null,k.els.lbl.c,a),G("ce801",null,Qa(h.Numeric),a),u(a,b,kc,null)):Nb(b.nextSibling)&&I({t:d.Value,id:null,v:"",n:"[]",st:h.Numeric,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1})}},Na=function(a){var f=na(b),c=Z(f,!0);Sa(Oc(a,c),null);
R()?"isNull"==a||"isNotNull"==a?u(V(),b,T,d.RightParenthesis):Ja(f):ja=!1},kc=function(a){switch(a){case "C":I({t:d.LeftBracket,id:null,v:"",n:k.els.lbl.cb,st:null,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1});a=b;I({t:d.RightBracket,id:null,v:"",n:k.els.lbl.ce,st:null,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1});b=F(a);S();u(ua(),b,fa,null);break;default:I({t:d.Value,id:null,v:"",n:"[]",st:h.Numeric,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1})}},fa=function(a,f){if(a==n.Number)a=parseInt(a,10),I({t:d.Calculation,
id:null,v:"",n:"[]",st:h.Numeric,ct:a,ft:l.None,it:p.None,h:!1,fv:!1}),b.setAttribute("ce207","true"),S();else if(a==n.Function){var c=A(w.fds,f);if(!g(c))throw Error("CL46");ob({t:d.Calculation,m:f,v:!1})}else{a=parseInt(a,10);var c="",e;switch(a){case n.Field:e=A(w.fds,f);if(!g(e))throw Error("CL48");c=e.v;e=e.n;break;case n.LeftParenthesis:e=k.els.lbl.pb;break;case n.RightParenthesis:e=k.els.lbl.pe;break;case n.Multiplication:e="&#215;";break;case n.Division:e="&#247;";break;case n.Addition:e=
"&#43;";break;case n.Subtraction:e="&#150;";break;default:throw Error("CL64");}I({t:d.Calculation,id:null,v:c,n:e,st:null,ct:a,ft:l.None,it:p.None,h:!1,fv:!1});R()&&u(ua(),b,fa,null)}},Tc=function(a){var f=[];G(n.Number,null,Qa(h.Numeric),f);a=Fb(a);for(var c=0;c<a.length;c++)G(a[c].t==d.Function?n.Function:n.Field,a[c].v,a[c].n,f);J=P=!0;u(f,b,fa,null)},Vc=function(a){I({t:d.Value,id:null,v:a,n:ub(a),st:h.Bool,ct:null,ft:l.None,it:p.None,h:!1,fv:!1});b.setAttribute("ce206",a);R()&&u(V(),b,T,d.RightParenthesis)},
Wc=function(a){I({t:d.Value,id:null,v:a,n:A(r,a).Name,st:h.Enum,ct:null,ft:l.None,it:p.None,h:!1,fv:!1});r=null;b.setAttribute("ce206",a);R()&&u(V(),b,T,d.RightParenthesis)},ta=function(a,f){if(g(f)&&parseInt(f,10)==d.LeftParenthesis)I({t:d.LeftParenthesis,id:null,v:"(",n:k.els.lbl.pb,st:null,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1}),R()&&u(sa(),b,ta,d.LeftParenthesis);else switch(a){case "ce802":case "ce803":for(var c=[],e=0;e<w.fds.length;e++){var v=w.fds[e];v.t==d.Field&&v.o==h.Collection&&v.ct==
z.Reference&&c.push(v)}e=[];for(v=0;v<c.length;v++)G(a,c[v].v,c[v].n,e);u(e,b,Gd,null);break;default:c=A(w.fds,a),c.t==d.Function?ob({t:c.t,m:a,v:!1}):(Sa(c,null),R()&&u(Ra(c),b,Na,null))}},qc=function(a){I({t:d.Value,id:null,v:a,n:A(r,a).Name,st:h.Numeric,ct:n.None,ft:l.None,it:p.Field,h:!1,fv:!1});r=null;b.setAttribute("ce206",a);R()&&u(V(),b,T,d.RightParenthesis)},Gd=function(a,f){var c=A(w.fds,f);I({t:d.Exists,id:null,v:a,n:ic(a),st:null,ct:null,ft:l.None,it:p.None,h:!1,fv:!1});Sa(c,null);I({t:d.Where,
id:null,v:a,n:eb(k.els.dsc,"where"),st:null,ct:null,ft:l.None,it:p.None,h:!1,fv:!1});I({t:d.LeftSource,id:null,v:c.cv,n:k.els.lbl.ub,st:null,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1});c=b;I({t:d.RightSource,id:null,v:w.n,n:k.els.lbl.ue,st:null,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1});b=F(c);O(b);u(sa(),b,ta,d.LeftParenthesis)},oc=function(a){J=!0;a=A(w.fds,a);var f=Ma(b,d.Field);b=F(f);Sa(a,null)},td=function(a){J=!0;I({t:d.Exists,id:null,v:a,n:ic(a),st:null,ct:null,ft:l.None,it:p.None,h:!1,fv:!1})},
xb=function(a){a=A(w.fds,a);Sa(a,null);I({t:d.Setter,id:null,v:"to",n:eb(k.els.str,"to"),st:a.o,ct:null,ft:l.None,it:p.None,h:!1,fv:!1});R()?Ja(na(b)):ja=!1},T=function(a,f){"else"==a||"elseIf"==a?Hb(a):g(f)&&parseInt(f,10)==d.RightParenthesis?(I({t:d.RightParenthesis,id:null,v:")",n:k.els.lbl.pe,st:null,ct:n.None,ft:l.None,it:p.None,h:!1,fv:!1}),R()&&u(V(),b,T,d.RightParenthesis)):(Sa(A(k.els.cls,a),null),("then"==a||Da(b))&&R()?u(Ha(),b,Ia,null):R()&&u(sa(),b,ta,d.LeftParenthesis))},Ed=function(a){var f=
Aa(b),f=g(f)?A(w.fds,f.getAttribute("ce208")):null,f=g(f)?g(f.rt)?f.rt.f:f.f:L.defaultFormat(),c=!0,m=hb(b);g(m)&&x(m)==d.Value&&Z(m)==h.Date&&(b=F(m),c=!1);c?I({t:d.Value,id:null,v:a,n:e.formatDate(new Date(a),f),st:h.Date,ct:null,ft:l.None,it:p.None,h:!1,fv:!1}):(b.setAttribute("ce206",a),e.text(b,e.formatDate(new Date(a),f)));L.hide();P=!1;q=0;S();R()&&u(V(),b,T,d.RightParenthesis)},Fd=function(a,f){var c=!0;if(g(b.nextSibling)){var m=hb(b.nextSibling);g(m)&&x(m)==d.Value&&Z(m)==h.Time&&(b=F(m),
c=!1)}c?I({t:d.Value,id:null,v:a,n:f,st:h.Time,ct:null,ft:l.None,it:p.None,h:!1,fv:!1}):(b.setAttribute("ce206",a),e.text(b,f));ka.hide();P=!1;q=0;S();R()&&u(V(),b,T,d.RightParenthesis)},Ia=function(a){"set"==a?(I({t:d.Setter,id:null,v:"set",n:eb(k.els.str,"set"),st:null,ct:null,ft:l.None,it:p.None,h:!1,fv:!1}),R()?u(wb(),b,xb,null):ja=!1):ob({t:A(w.acs,a).t,m:a,v:!1})},Hb=function(a){var f="and"==a;Sa(A(f?k.els.cls:k.els.fls,a),null);R()&&(f?u(Ha(),b,Ia,null):"else"==a?u(Ha(),b,Ia,null):u(sa(),b,
ta,d.LeftParenthesis))},I=function(a){var b=new e.Client.Element;b.n=a.n;b.v=a.v;b.t=a.t;b.o=g(a.st)?a.st:h.None;b.CalType=g(a.ct)?a.ct:n.None;b.FuncType=g(a.ft)?a.ft:l.None;b.q=a.fv;b.InpType=g(a.it)?a.it:p.None;Sa(b,a.id,a.h)},Sa=function(a,f,c){var e,v;e=!(!g(b)||!g(b.nextSibling));v=document.createElement("SPAN");v.id=g(f)?f:H.id+Ua;Ua++;99999999999<Ua&&(Ua=0);a.t==d.Field&&a.o==h.Collection?(f=A(w.fds,a.v),f.ct==z.Reference?g(f.cn)?v.innerHTML=f.cn:v.innerHTML=a.n:v.innerHTML=a.n):v.innerHTML=
a.n;a.t==d.Value?(va(v,k.valueCss),g(v.getAttribute("ce206"))||v.setAttribute("ce206",a.v)):a.t==d.Calculation?(a.CalType!=n.Function||a.FuncType!=l.Name&&a.FuncType!=l.End||va(v,k.valueCss),va(v,k.calcCss),g(a.v)&&v.setAttribute("ce206",a.v),a.CalType==n.RightParenthesis?(v.onmouseover=function(a){Ob(this,ed)},v.onmouseout=function(a){Pb(this,ed)},v.style.paddingRight=v.style.paddingLeft="2px"):a.CalType==n.LeftParenthesis&&(v.onmouseover=function(a){Ob(this,fd)},v.onmouseout=function(a){Pb(this,
fd)},v.style.paddingRight=v.style.paddingLeft="2px")):a.t==d.Flow?va(v,k.flowCss):a.t==d.Field?va(v,k.fieldCss):a.t==d.Function?a.FuncType==l.Name||a.FuncType==l.End?(v.setAttribute("ce216",a.q?"true":"false"),a.q||a.CalType==n.Function?va(v,k.valueCss):va(v,k.fieldCss)):(va(v,k.paramCss),a.InpType==p.Input&&g(a.v)&&v.setAttribute("ce206",a.v)):a.t==d.Action?a.FuncType==l.Name||a.FuncType==l.End?va(v,k.actionCss):(va(v,k.paramCss),a.InpType==p.Input&&g(a.v)&&v.setAttribute("ce206",a.v)):a.t==d.Operator?
va(v,k.operCss):a.t==d.LeftBracket||a.t==d.RightBracket?va(v,k.skobkiCss):a.t==d.LeftSource||a.t==d.RightSource?va(v,k.braceCss):a.t==d.Clause||a.t==d.Setter||a.t==d.Where||a.t==d.Exists?va(v,k.clauseCss):a.t==d.Tab?va(v,k.tabCss):a.t==d.NewLine&&va(v,k.lineCss);a.t==d.Tab?v.style.paddingRight=v.style.paddingLeft="8px":a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=l.End?(a.t==d.RightParenthesis?(v.onmouseover=function(a){Ob(this,gd)},v.onmouseout=function(a){Pb(this,gd)},g(k.skobkiCss)&&
0<k.skobkiCss.length&&(v.className=X(k.skobkiCss))):a.t==d.LeftParenthesis&&(v.onmouseover=function(a){Ob(this,hd)},v.onmouseout=function(a){Pb(this,hd)},g(k.skobkiCss)&&0<k.skobkiCss.length&&(v.className=X(k.skobkiCss))),v.style.paddingRight=v.style.paddingLeft="2px"):(f=A(a.t==d.Action?w.acs:w.fds,a.v),g(f)&&g(f.ps)&&0!=f.ps.length||(v.style.paddingRight=v.style.paddingLeft="0px",v.style.width="2px"));v.style.paddingBottom="2px";v.style.marginTop=v.style.marginLeft=v.style.marginRight=v.style.marginBottom=
"0px";v.style.display="inline-block";v.style.whiteSpace="nowrap";a.CalType!=n.Number&&(a.t!=d.Value&&a.FuncType!=l.Param||a.InpType==p.Field||a.o!=h.String&&a.o!=h.Numeric)||(v.style.cursor="text");v.setAttribute("ce202",a.t);a.t==d.Field&&a.o==h.Bool&&(a.ir?v.setAttribute("ce213","true"):(f=A(w.fds,a.v),g(f)&&g(f.ir)&&f.ir&&v.setAttribute("ce213","true")));v.setAttribute("ce203",g(a.CalType)?a.CalType:n.None);v.setAttribute("ce204",g(a.FuncType)?a.FuncType:l.None);v.setAttribute("ce205",g(a.InpType)?
a.InpType:p.None);v.setAttribute("ce208",a.v);g(a.o)&&a.o!=h.None?(v.setAttribute("ce209",a.o),Ca(a.t,a.o,a.CalType,a.InpType)&&a.InpType!=p.Field&&v.setAttribute("ce207","true")):v.setAttribute("ce209",h.None);J&&Pa();J=!1;if(e){if(e=b.nextSibling,H.insertBefore(v,b.nextSibling),a.t!=d.Tab){if(g(e)&&x(e)==d.Tab)for(;g(e)&&x(e)==d.Tab;)f=e.nextSibling,H.removeChild(e),e=f;if(g(e)){if(a.t==d.RightBracket&&x(e)==d.LeftBracket){for(;x(e)!=d.RightBracket;)f=e.nextSibling,H.removeChild(e),e=f;H.removeChild(e)}a.t!=
d.Calculation||a.CalType!=n.Field&&a.CalType!=n.Number?(a.t==d.Value||a.t==d.Operator&&"isNull"!=a.v&&"isNotNull"!=a.v||a.t==d.Clause&&"then"==a.v||a.t==d.Flow&&"else"==a.v)&&a.t==x(e)&&a.o==Z(e)&&H.removeChild(e):a.t==x(e)&&Hd(a.CalType,Q(e))&&H.removeChild(e)}}}else H.appendChild(v);a.t!=d.Function&&a.t!=d.Action&&a.t!=d.Calculation||a.FuncType!=l.End||!pa(v)?b=c?v:F(v):Ga(v,c);k.titles&&Id(a);ba=!1;S()},Id=function(a){function f(a){a=A(w.fds,a);g(a)&&g(a.d)&&(b.title=Oa(a.d))}switch(a.t){case d.Function:case d.Action:switch(a.FuncType){case l.Name:a=
A(a.t==d.Function?w.fds:w.acs,a.v);g(a)&&g(a.d)&&(b.title=Oa(a.d));break;case l.Param:if(a=Y(b),g(a)&&0<a.ps.length){var c=fb(b);0<=c&&(a=a.ps[c],g(a)&&g(a.d)&&(b.title=Oa(a.d)))}}break;case d.Field:f(a.v);break;case d.Value:a.InpType==p.Field&&f(a.v);break;case d.Calculation:a.CalType==n.Field&&f(a.v)}},Pa=function(){var a;x(b)==d.HtmlTag&&(b=F(g(b.nextSibling)?b.nextSibling:b.previousSibling),O(b));switch(x(b)){case d.Calculation:case d.Function:case d.Action:switch(N(b)){case l.Name:for(;N(b)!=
l.End;)a=b.nextSibling,H.removeChild(b),b=a;ga(b);break;case l.End:for(;N(b)!=l.Name;)ga(b);ga(b);break;case l.Comma:for(ga(b);N(b)!=l.Name&&N(b)!=l.Comma;)ga(b);break;case l.Param:a=hb(b.nextSibling);if(N(a)==l.Comma)b=a,Pa();else for(ga(b);N(b)!=l.Name&&N(b)!=l.Param;)ga(b);break;default:ga(b)}break;case d.Field:a=A(w.fds,b.getAttribute("ce208"));g(a)&&a.o==h.Collection&&a.ct==z.Reference?id(b):ga(b);break;case d.LeftBracket:if(!g(b.nextSibling))throw Error("CL82");for(;x(b)!=d.RightBracket;)a=
b.nextSibling,H.removeChild(b),b=a;ga(b);break;case d.RightBracket:if(!g(b.previousSibling))throw Error("CL84");for(;x(b)!=d.LeftBracket;)ga(b);ga(b);break;case d.RightSource:case d.LeftSource:case d.Where:case d.Exists:id(b);break;default:ga(b)}S()},id=function(a){if(!J){a=x(b)==d.RightSource?b:jd(b,d.RightSource);if(!g(a)){ga(b);return}for(var f=uc(a,d.Exists).id,c;a.id!=f;)c=a.previousSibling,H.removeChild(a),a=c;b=F(a)}ga(b)},ga=function(a){if(g(a.previousSibling)){var f=a.previousSibling;H.removeChild(a);
b=F(f);O(b)}},Ob=function(a,f){if(!Qb(a)){var c=f(a);if(g(c)){if(1==q||a.id!=b.id)a.className=a.className+" "+k.highlightBg;Qb(c)||1!=q&&c.id==b.id||(c.className=c.className+" "+k.highlightBg)}}},Pb=function(a,f){if(!Qb(a)){var c=f(a);if(g(c)){if(1==q||a.id!=b.id)a.className=a.className.replace(" "+k.highlightBg,"");Qb(c)||1!=q&&c.id==b.id||(c.className=c.className.replace(" "+k.highlightBg,""))}}},Qb=function(a){if(!g(W)||0==W.length)return!1;for(var b=0;b<W.length;b++)if(W[b]==a.id)return!0;return!1},
gd=function(a){var b=1;a=a.previousSibling;for(var c;g(a);){c=x(a);if(c==d.RightSource)if(a=uc(a,d.LeftSource),g(a)&&g(a.previousSibling))a=a.previousSibling,c=x(a);else{a=null;break}c==d.RightParenthesis?b++:c==d.LeftParenthesis&&b--;if(0==b)break;else if(c==d.LeftSource||c==d.Flow){a=null;break}else a=a.previousSibling}return g(a)?a:null},hd=function(a){var b=1;a=a.nextSibling;for(var c;g(a);){c=x(a);if(c==d.LeftSource)if(a=jd(a,d.RightSource),g(a)&&g(a.nextSibling))a=a.nextSibling,c=x(a);else{a=
null;break}c==d.RightParenthesis?b--:c==d.LeftParenthesis&&b++;if(0==b)break;else if(c==d.RightSource||c==d.Flow){a=null;break}else a=a.nextSibling}return g(a)?a:null},ed=function(a){var b=1;for(a=a.previousSibling;g(a)&&(Q(a)==n.LeftParenthesis?b--:Q(a)==n.RightParenthesis&&b++,0!=b);)a=a.previousSibling;return g(a)&&x(a)!=d.LeftBracket?a:null},fd=function(a){var b=1;for(a=a.nextSibling;x(a)!=d.RightBracket&&(Q(a)==n.RightParenthesis?b--:Q(a)==n.LeftParenthesis&&b++,0!=b);)a=a.nextSibling;return g(a)&&
x(a)!=d.RightBracket?a:null},uc=function(a,b){for(var c=0,e=0,h;g(a);){h=x(a);h==d.LeftSource&&c++;if(c==e&&h==b)return a;h==d.RightSource&&e++;a=g(a.previousSibling)&&x(a.previousSibling)!=d.Flow?a.previousSibling:null}return null},jd=function(a,b){for(var c=0,e=0,h;g(a);){h=x(a);h==d.RightSource&&e++;if(c==e&&h==b)return a;h==d.LeftSource&&c++;a=g(a.nextSibling)&&x(a.nextSibling)!=d.Flow?a.nextSibling:null}return null},cb=function(a,c){if(!g(b.nextSibling)||x(b.nextSibling)!=d.HtmlTag||!g(b.nextSibling.nextSibling.nextSibling)||
x(b.nextSibling.nextSibling.nextSibling)!=d.HtmlTag){var e=document.createElement("BR");e.setAttribute("ce202",d.HtmlTag);g(b)&&g(b.nextSibling)||a?H.insertBefore(e,a?b:b.nextSibling):H.appendChild(e);b=c?e:F(e);I({t:d.NewLine,id:null,v:"",n:k.tochki?"&#149;&nbsp;":"&nbsp;&nbsp;",st:null,ct:null,ft:null,fv:!1,it:null,h:c})}},kd=function(){x(b)==d.NewLine||x(b.previousSibling)==d.NewLine?(b=na(b.previousSibling),Rb(),b=F(g(b.nextSibling)?b.nextSibling:b),O(b)):pb(b.previousSibling)||(b=b.previousSibling,
Pa(),b=F(g(b.nextSibling)?b.nextSibling:b),O(b))},Xc=function(){Lc();k.help&&lb(k.els.ms.i101);qa=0;t="";q=2;O(null)},Dc=function(){if(g(H)){6!=q&&8!=q||xa();Xc();bb();if(k.tools){ha.setValue(k.els.lbl.n);ha.setClass(k.nameDefCss);la.setValue(k.els.lbl.d);la.setClass(k.descDefCss);var a=document.getElementById("ceC"+H.id);a&&a.parentNode.removeChild(a)}ea=null;q=1}},Nb=function(a){return g(a)&&(a=hb(a),g(a)&&Ca(x(a),Z(a),Q(a),ia(a))&&ia(a)!=p.Field)?(Sc(a),J=P=!1,S(),!1):!0},fc=function(){if(g(W)&&
0<W.length){for(var a,b=0;b<W.length;b++)a=document.getElementById(W[b]),g(a)&&(a.className=a.className.replace(" "+k.highlightBg,""),a.title="");W=[]}k.help&&(da.className=da.className.replace(" "+k.invalidColor,""))},Ic=function(a){var b="ceT"+H.id;ca=document.getElementById(b);g(ca)&&ca.parentNode.removeChild(ca);ca=document.createElement("DIV");ca.id=b;ca.className=X(k.toolCss);b=document.createElement("TABLE");b.cellPadding=b.cellSpacing=b.border=0;b.style.width="100%";var c=b.insertRow(-1),
m=c.insertCell(-1);m.style.paddingRight="6px";a?Jc(m):(ya=document.createElement("SPAN"),ya.id="ceRl"+H.id,ya.className=X(k.rulesCss),ya.innerHTML=k.els.lbl.r+"&nbsp;&#9662;",m.appendChild(ya),ya.onclick=function(a){O(null);(new e.Event(a)).stopPropagation();Eb();P=!0;0<t.length?aa(K,ya,Lb,null):u(K,ya,Lb,null);q=8},m=c.insertCell(-1),m.style.textAlign="right",spnShared=document.createElement("SPAN"),spnShared.className=k.lblCss,spnShared.style.display="none",m.appendChild(spnShared),ha=new e.TextBox.Control,
ha.init(new e.TextBox.Settings(m,"ceTl"+H.id,X(k.nameCss),X(k.nameDefCss),50,k.els.lbl.n,k.els.er.e104,X(k.invalidColor))),la=new e.TextBox.Control,la.init(new e.TextBox.Settings(m,"ceTd"+H.id,X(k.descCss),X(k.descDefCss),80,k.els.lbl.d,k.els.er.e104,X(k.invalidColor))),a=document.createElement("SPAN"),a.id="ceA"+H.id,a.className=X(k.saveButCss),a.innerHTML=k.els.lbl.a,m.appendChild(a),a.onclick=function(a){6!=q&&8!=q||xa();a=Fa();0!=a.length&&(1!=a.length||g(x(a[0]))&&x(a[0])!=d.Flow)?vc("ceSave"):
alert(k.els.er.e106)});ca.appendChild(b);H.appendChild(ca)},Jc=function(a,b){if(g(k.els.ms.i101)){var c="ceH"+H.id;da=document.getElementById(c);g(da)&&da.parentNode.removeChild(da);da=document.createElement("DIV");da.id=c;b&&(da.className=X(k.helpCss));a.appendChild(da);da.innerHTML=k.els.ms.i101}else Kc()},Kc=function(){var a=document.getElementById("ceH"+H.id);g(a)&&a.parentNode.removeChild(a);da=null;k.help=!1},vc=function(a){ab=a;O(null);if(jb)switch(ab){case "ceDelete":if(!g(ea))throw Error("CL31");
if(!g(ac)){alert("The Delete action is not defined");break}Va=!0;ac(ea);break;case "ceSave":if(!g($b)){alert("The Save action is not defined");break}Va=!1;$b($a.serialize(Db()));break;default:g(bc)?(Va=!0,bc(a)):alert("The Load action is not defined")}else if(yc){Va="ceSave"!=ab;try{eval(k.pb+"('"+Bb+"','')")}catch(b){throw Error("CL81");}}else switch(ab){case "ceDelete":if(!g(ea))throw Error("CL32");k.pb&&k.pb.d?window.location=k.pb.d.replace("_ce_",ea):alert("The Delete action is not defined");
break;case "ceSave":if(!g(Cb))throw Error("CL33");if(k.pb&&k.pb.s)if(g(Xa))gc(),Xa.action?Xa.action=k.pb.s:Xa.setAttribute("action",k.pb.s),Xa.submit();else{a=document.createElement("FORM");document.body.appendChild(a);a.action?a.action=k.pb.s:a.setAttribute("action",k.pb.s);a.method?a.method="post":a.setAttribute("method","post");var c=document.createElement("INPUT");c.type="hidden";c.id=Cb;c.name=Bb;Va=!1;c.value=$a.serialize(Db());a.appendChild(c);a.submit()}else alert("The Save action is not defined");
break;default:k.pb&&k.pb.l?window.location=k.pb.l.replace("_ce_",ab):alert("The Load action is not defined")}},Dd=function(a){if(k.help){var b=A(w.fds,a),c=null;g(b)?b.d&&(c=b.d):(b=A(w.acs,a),g(b)&&b.d?c=b.d:(b=A(k.els.rls,a),g(b)&&b.d&&(c=b.d)));g(c)&&0<c.length?lb(c):kb()}},Lb=function(a){"ceEval"==a||"ceExec"==a?(k.isEval="ceEval"==a,Dc()):(za.close(),q=1,vc(a))},Bc=function(){var a="ceC"+H.id;if(!g(document.getElementById(a))){var b=document.createElement("SPAN");b.id=a;b.className=X(k.deleteCss);
b.innerHTML=k.els.lbl.u;e.getChildrenByTagName(ca,"TABLE",!0)[0].rows[0].cells[1].appendChild(b);b.onclick=function(a){confirm(k.els.er.e105)&&vc("ceDelete")}}},Mc=function(){if(g(U))try{var a=U.parentNode;g(a)||(a=document.body);a.removeChild(U)}catch(b){U.style.display="none"}U=document.createElement("DIV");U.id=(new Date).getMilliseconds()*Ua+"";U.style.position="absolute";U.style.left="0px";U.style.top="0px";U.style.textAlign="right";U.style.width="200px";a=document.createElement("A");a.innerHTML=
"Code Effects Software";a.href="http://codeeffects.com";a.target="_blank";a.style.fontSize="10px";U.appendChild(a);document.body.appendChild(U);ld()},ld=function(){if(hc&&g(U)){var a=wa(k.tools||k.help?ca:H),b=wa(U);U.style.left=a.x+a.width-b.width-8+"px";a=a.y-b.height-4;0>a&&(a=0);U.style.top=a+"px"}},hc=0<Xb(document.body,"ce002","true").length,db=function(a){a=eval(bd(a));return g(a.ce)?a.ce:a},A=function(a,b){if(g(a)){g(a.ce)&&(a=a.ce);for(var c,d=0;d<a.length;d++)if(c=a[d],g(c.v)&&c.v==b||g(c.ID)&&
c.ID==b)return c}return null},sa=function(){var a=[];if(w.references){G("ce802",d.Field,k.els.lbl.h,a);G("ce803",d.Field,k.els.lbl.l,a);for(var b=0;b<w.fds.length;b++){var c=w.fds[b];if(c.t==d.Field&&c.o==h.Collection){if(c.ct==z.Generic)throw Error("CL83");c.ct!=z.Reference&&a.push(c)}else a.push(c)}}else a=w.fds;for(var e=g(ea),l=[],b=0;b<a.length;b++)if(c=a[b],!g(c.gtb)||c.gtb)c.ir&&e&&c.v==ea||l.push(c);return l},wb=function(){for(var a=[],b,c=0;c<w.fds.length;c++)b=w.fds[c],b.ir||b.t==d.Function||
b.o==h.Collection||g(b.st)&&!b.st||a.push(b);return a},nc=function(a){for(var b=[],c=A(w.fds,a),d=0;d<w.fds.length;d++)a=w.fds[d],a.v!=c.v&&a.o==h.Collection&&a.ct==z.Reference&&a.cc==c.cc&&a.cl==c.cl&&a.cv==c.cv&&b.push(a);return b},Ha=function(){for(var a=[],b=!1,c=0,d;c<w.fds.length;c++)if(d=w.fds[c],!g(d.st)||d.st){b=!0;break}b&&G("set",null,k.els.lbl.w,a);for(c=0;c<w.acs.length;c++)a.push(w.acs[c]);return a},V=function(){if(Da(b))return Gb();var a=[],c;c=0;for(var e=b,m;g(e);){m=x(e);if(m==d.Flow)break;
m==d.LeftSource?c--:m==d.RightSource&&c++;e=g(e.previousSibling)&&x(e.previousSibling)!=d.Flow?e.previousSibling:null}c=0==c;for(m=0;m<k.els.cls.length;m++)e=k.els.cls[m],(!k.isEval&&c||"then"!=e.v)&&a.push(e);return a},sd=function(a){for(var b=[],c,d=0;d<k.els.cls.length;d++)c=k.els.cls[d],"then"!=c.v&&c.v!=a&&b.push(c);return b},Oc=function(a,b){for(var c=0;c<k.els.ops.length;c++)if(k.els.ops[c].v==a&&k.els.ops[c].o==b)return k.els.ops[c];return null},Ra=function(a,b){var c=[],e,l,n,p;a.t==d.Function?
(l=a.rt.o,n=a.rt.l,p=g(a.rt.mds)):a.ir?(n=p=!1,l=h.Bool):(n=a.l,l=a.o,p=g(a.mds));for(var q=0;q<k.els.ops.length;q++)if(e=k.els.ops[q],e.o==l&&(!g(b)||e.v!=b)&&(n||"isNull"!=e.v&&"isNotNull"!=e.v)){if(l==h.Numeric&&p)if(n){if("isNull"!=e.v&&"isNotNull"!=e.v&&"equal"!=e.v&&"notEqual"!=e.v)continue}else if("equal"!=e.v&&"notEqual"!=e.v)continue;c.push(e)}return c},Zc=function(){var a=[];G("true",null,k.els.lbl.t,a);G("false",null,k.els.lbl.f,a);return a},dd=function(a,c){var e=[];Da(b);for(var m,k,
l,n,p=c.t==d.Function?c.rt.e:c.e,q=c.t==d.Function?c.rt.mds:c.mds,r=0;r<w.fds.length;r++)if(m=w.fds[r],m.o!=h.Collection&&(k=cd(m),n=m.t==d.Function?m.rt.e:m.e,l=m.t==d.Function?m.rt.mds:m.mds,k!=h.Enum||g(p)&&p==n))k!=a||m.ir||(g(l)?g(q)&&l==q&&e.push(m):g(q)||e.push(m));return e},Fb=function(a){for(var b=[],c,e=0;e<w.fds.length;e++)c=w.fds[e],(c.t!=d.Field||c.ir||g(c.mds)||c.o!=h.Numeric||!c.i||g(a)&&c.v==a)&&(c.t!=d.Function||c.rt.o!=h.Numeric||!c.i||g(a)&&c.v==a)||b.push(c);return b},Za=function(a){var b=
Yc(a),c=null;null!=b&&(c=b.Client?eval(b.Data[0]+"()"):eval("CodeEffects.Rule."+a));return c},Yc=function(a){if(!g(k.els.mds))return null;for(var b=0;b<k.els.mds.length;b++)if(k.els.mds[b].Name==a)return k.els.mds[b];return null},cd=function(a){if(a.t==d.Function)return a.rt.o;var b=a.o;if(b==h.Collection){if(a.ct!=z.Value)throw Error("CL71");return a.co}return b},Sc=function(a){if(g(La)){var c=document.getElementById(La);g(c)&&(c.className=c.className.replace(" "+k.currentBg,""))}g(b)&&(b.className=
b.className.replace(" "+k.currentBg,""));a.setAttribute("ce207","true");b=a},ra=function(){if(g(b)){b.removeAttribute("ce207");var a=x(b);if(a==d.Value&&Z(b)==h.Numeric&&ia(b)!=p.Field||a==d.Calculation&&Q(b)==n.Number||(a==d.Function||a==d.Action)&&ia(b)==p.Input&&Z(b)==h.Numeric){var c,e;var m=b.getAttribute("ce206");try{if(g(m)){var k=parseFloat(m);c=g(k)&&"-0."!=m&&"0."!=m}else c=!1}catch(q){c=!1}c?a!=d.Calculation&&(g(b.getAttribute("ce211"))?e=parseInt(b.getAttribute("ce211"),10):(c=Aa(b),g(c)&&
(a=A(a==d.Action?w.acs:w.fds,c.getAttribute("ce208")),N(b)==l.Param?(a=a.ps[fb(b)],g(a.min)&&(e=a.min)):e=a.t==d.Function&&g(a.rt.min)?a.rt.min:a.t==d.Field&&g(a.min)?a.min:0)),e>parseInt(b.getAttribute("ce206"),10)&&(b.innerHTML="["+e+"]",b.setAttribute("ce206",e))):a==d.Calculation?(b.innerHTML="[0]",b.setAttribute("ce206","0")):(e=0,g(b.getAttribute("ce211"))?e=parseInt(b.getAttribute("ce211"),10):(c=Aa(b),g(c)&&(a=A(a==d.Action?w.acs:w.fds,c.getAttribute("ce208")),a.t==d.Function&&g(a.rt.min)?
e=a.rt.min:a.t==d.Field&&g(a.min)&&(e=a.min))),b.innerHTML="["+e+"]",b.setAttribute("ce206",e));g(b.getAttribute("ce212"))&&(e=parseInt(b.getAttribute("ce212"),10),e<parseInt(b.getAttribute("ce206"),10)&&(b.innerHTML="["+e+"]",b.setAttribute("ce206",e)))}}},Gb=function(){var a=[];a.push(A(k.els.cls,"and"));for(var c=Fa(),e=!1,g=!1,h=0;h<c.length;h++){if(x(c[h])==d.Flow&&"else"==c[h].getAttribute("ce208")){e=!0;break}c[h].id==b.id&&(g=!0)}if(!g&&e)return a;for(c=0;c<k.els.fls.length;c++)"if"==k.els.fls[c].v||
e&&"else"==k.els.fls[c].v||a.push(k.els.fls[c]);return a},eb=function(a,b){for(var c,d=0;d<a.length;d++)if(c=a[d],c.v==b)return c.n;return null},ic=function(a){return eb(k.els.dsc,"ce803"==a?"doesNotExist":"exists")},ua=function(){function a(a){var c=0,f=0,e;a:{for(e=b;g(e);){if(x(e)==d.RightBracket)break a;e=e.nextSibling}e=null}for(e=e.previousSibling;g(e)&&x(e)!=d.LeftBracket;)Q(e)==n.LeftParenthesis&&c++,Q(e)==n.RightParenthesis&&f++,e=e.previousSibling;c>f&&G(n.RightParenthesis,null,k.els.lbl.pe,
a);G(n.Addition,null,"&#43;",a);G(n.Subtraction,null,"&#150;",a);G(n.Multiplication,null,"&#215;",a);G(n.Division,null,"&#247;",a)}var c=[];switch(x(na(b))){case d.LeftBracket:G(n.LeftParenthesis,null,k.els.lbl.pb,c);G(n.Number,null,Qa(h.Numeric),c);for(var e=Fb(),m=0;m<e.length;m++)G(e[m].t==d.Function?n.Function:n.Field,e[m].v,e[m].n,c);break;case d.Value:case d.Calculation:e=Q(b);e==n.None&&(e=Q(na(b)));switch(e){case n.Number:case n.Field:case n.RightParenthesis:a(c);break;case n.Function:N(b)==
l.End&&a(c);break;case n.LeftParenthesis:case n.Addition:case n.Subtraction:case n.Multiplication:case n.Division:for(G(n.LeftParenthesis,null,k.els.lbl.pb,c),G(n.Number,null,Qa(h.Numeric),c),e=Fb(),m=0;m<e.length;m++)G(e[m].t==d.Function?n.Function:n.Field,e[m].v,e[m].n,c)}break;default:throw Error("CL80");}return c},tc=function(a,c){if(!g(a)||0==a.ps.length)return c;var d=fb(b);for(0>d&&(d=0);d<a.ps.length;){if(g(a.ps[d].f))return a.ps[d].f;d++}return c},G=function(a,b,c,d){var h=new e.Menu.Item;
h.ID=a;g(b)&&(h.Type=b+"");h.Name=c;d.push(h)},Hd=function(a,b){if(a==n.None||b==n.None)throw Error("CL90");switch(a){case n.Field:return b==n.Number||b==n.Field;case n.Number:return b==n.Field||b==n.Number;case n.LeftParenthesis:return b==n.LeftParenthesis;case n.RightParenthesis:return b==n.RightParenthesis;default:return b==n.Multiplication||b==n.Division||b==n.Addition||b==n.Subtraction}},Uc=function(a,b){var c=[];if(!g(a)||0==a.length)return c;b=b.toLowerCase();for(var d,e=0;e<a.length;e++)d=
a[e].n||a[e].Name,d.length>=b.length&&d.substr(0,b.length).toLowerCase()==b&&c.push(a[e]);return c},Jd=function(){if(!g(b))return"i101";if(8==q)return"i126";var a=na(b),c;switch(x(a)){case d.Flow:return"else"==a.getAttribute("ce208")?"i110":"i103";case d.LeftSource:case d.LeftParenthesis:return"i103";case d.RightSource:case d.RightParenthesis:return"i111";case d.Field:if(ba)return"i127";a=A(w.fds,a.getAttribute("ce208"));return g(a)?a.o==h.Collection&&a.ct==z.Reference?"i124":"i104":"i124";case d.Exists:return ba?
"i136":"i135";case d.Where:return"i124";case d.LeftBracket:return"i106";case d.RightBracket:return"i121";case d.Calculation:return"i108";case d.Action:switch(N(a)){case l.End:return pa(a)&&ba?"i128":"else"==mc(a,d.Flow).getAttribute("ce208")?"i124":"i125";case l.Name:return ba?"i128":"i123";default:return"i123"}case d.Function:switch(N(a)){case l.End:return pa(a)&&ba?"i127":"i104";case l.Name:return ba?"i127":"i123";default:return"i123"}case d.Operator:if(ba)return"i129";c=Z(a);return c==h.Numeric?
(a=Aa(a),a=g(a)?A(w.fds,a.getAttribute("ce208")):null,g(a)&&a.cal?"i122":"i113"):c==h.String?"i113":c==h.Date?"i114":c==h.Time?"i117":"i119";case d.Value:return c=Z(a),c==h.String||c==h.Numeric?g(a.getAttribute("ce207"))?"i105":ba?"i131":"i107":c==h.Date?3==q?"i109":ba?"i132":"i115":c==h.Time?4==q?"i116":ba?"i133":"i118":ba?"i134":"i120";case d.Clause:return"then"==a.getAttribute("ce208")?"i110":ba?"i129":"i103";default:return"i122"}},Qa=function(a,b){switch(a){case h.String:return k.els.lbl.s;case h.Date:return k.els.lbl.v;
case h.Time:return k.els.lbl.j;case h.Numeric:return b?k.els.lbl.e:k.els.lbl.m;case h.Bool:return k.els.lbl.b;case h.Enum:return k.els.lbl.e;default:throw Error("CL45");}},Da=function(a){var b=g(a.getAttribute("ce202"))?x(a):null;return b==d.Setter||b==d.Action?!0:b==d.Flow?!1:g(a.previousSibling)?Da(a.previousSibling):!1},Pc=function(a,b,c){if(!g(a)||!g(a.ps))return null;for(var d=c;d<=a.ps.length;d++)if(a.ps[d].o==b)return a.ps[d];return 0<c?Pc(a,b,0):null},mb=function(a,b){var c=x(a),e=N(a);return a.getAttribute&&
g(a.getAttribute("ce204"))&&(c==d.Function||c==d.Action||c==d.Calculation&&(e==l.Name||e==l.End))&&e==b?a:g(a.previousSibling)?mb(a.previousSibling,b):null},jc=function(a,b){var c=x(a),e=N(a);return a.getAttribute&&g(a.getAttribute("ce204"))&&(c==d.Function||c==d.Action||c==d.Calculation&&(e==l.Name||e==l.End))&&e==b?a:g(a.nextSibling)?jc(a.nextSibling,b):null},mc=function(a,b){return g(a)?a.getAttribute&&g(a.getAttribute("ce202"))&&x(a)==b?a:g(a.previousSibling)?mc(a.previousSibling,b):null:null},
Aa=function(a){return g(a)?g(a.getAttribute)&&g(a.getAttribute("ce202"))&&(x(a)==d.Field||d.Function&&N(a)==l.Name)?a:g(a.previousSibling)?Aa(a.previousSibling):null:null},md=function(a){if(!g(a))return null;if(g(a.getAttribute)&&g(a.getAttribute("ce202"))){var b=x(a);if(b==d.RightSource||b==d.LeftSource)return a;if(g(a.previousSibling))return md(a.previousSibling)}return null},Ma=function(a,b){return g(a)?g(a.getAttribute)&&g(a.getAttribute("ce202"))&&x(a)==b?a:g(a.nextSibling)?Ma(a.nextSibling,
b):null:null},Jb=function(a){return a.getAttribute&&g(a.getAttribute("ce202"))&&x(a)!=d.HtmlTag?a:g(a.nextSibling)?Jb(a.nextSibling):null},na=function(a){return Ib(a)?a:g(a.previousSibling)?na(a.previousSibling):null},hb=function(a){return Ib(a)?a:g(a.nextSibling)?hb(a.nextSibling):null},gb=function(a,b){if(!g(a))return null;var c=N(a);return c==l.End?null:c==l.Param&&Z(a,!0)==b?a:g(a.nextSibling)?gb(a.nextSibling,b):null},Cc=function(){K=[];var a;g(k.els.lbl.y)&&(a=new e.Menu.Item,a.ID="ceEval",
a.Name=k.els.lbl.y,K.push(a));g(k.els.lbl.x)&&(a=new e.Menu.Item,a.ID="ceExec",a.Name=k.els.lbl.x,K.push(a));if(g(k.els.rls))for(var b=0;b<k.els.rls.length;b++)a=new e.Menu.Item,a.ID=k.els.rls[b].v||k.els.rls[b].ID,a.Name=k.els.rls[b].n||k.els.rls[b].Name,K.push(a)},Ga=function(a,c){if(!c){var d=mb(a,l.Name);La=d.id;b=F(d)}b=b.nextSibling},O=function(a){w=null;var b=k.els.src[0].n;g(a)&&(a=md(a),g(a)&&(b=a.getAttribute("ce208")));for(a=0;a<k.els.src.length;a++)if(k.els.src[a].n==b){w=k.els.src[a];
g(w.fds)&&w.fds.length||(w.fds=[]);g(w.acs)&&w.acs.length||(w.acs=[]);if(!g(w.references))for(w.references=!1,a=0;a<w.fds.length;a++)if(b=w.fds[a],b.t==d.Field&&b.o==h.Collection&&b.ct==z.Reference){w.references=!0;break}break}if(!g(w))throw Error("CL91");},F=function(a){if(g(La)){var c=document.getElementById(La);g(c)&&(c.className=c.className.replace(" "+k.currentBg,""))}g(b)&&(b.className=b.className.replace(" "+k.currentBg,"").replace(" "+k.highlightBg,""));-1==a.className.indexOf(k.currentBg)&&
(a.className=a.className+" "+k.currentBg);return a},pa=function(a){var b=x(a),c=N(a);return b==d.Function||b==d.Action||b==d.Calculation&&(c==l.Name||c==l.End)?(a=Y(a),g(a)&&g(a.ps)?0==a.ps.length:!0):!1},Ib=function(a){return a.getAttribute&&g(a.getAttribute("ce202"))?(a=x(a),a!=d.Tab&&a!=d.NewLine&&a!=d.HtmlTag):!1},Ca=function(a,b,c,e){return a==d.Value&&(b==h.String||b==h.Numeric)||a==d.Calculation&&c==n.Number||(a==d.Function||a==d.Action)&&e==p.Input&&(b==h.String||b==h.Numeric)},oa=function(a){return 31<
a&&40>a||41<a&&60>a||61==a||63<a&&91>a||96<a&&123>a||222<a},Rc=function(){for(var a=Fa(),b=0;b<a.length;b++)switch(x(a[b])){case d.Clause:case d.Function:case d.Field:case d.Operator:case d.Value:case d.Action:case d.LeftParenthesis:case d.RightParenthesis:case d.Calculation:return!0}return!1},Ec=function(){try{window.clearInterval(Tb)}catch(a){}Tb=null},nd=function(){g(ib)&&bb();if(Ca(x(b),Z(b,!0),Q(b),ia(b))&&g(b.getAttribute("ce207"))){b.className=b.className.replace(" "+k.currentBg,"");if(g(b)&&
g(C)){var a=e.Client.browser==e.Client.type.Firefox?3:2,c=x(b),l=Z(b);c==d.Value?l==h.String?a+=zb:l==h.Numeric&&(a+=qb):c==d.Calculation&&Q(b)==n.Number?a=qb+2:c!=d.Function&&c!=d.Action||ia(b)!=p.Input||(l==h.String?a+=zb:l==h.Numeric&&(a+=qb));c=wa(b);C.style.left=c.x+c.width-a+"px";a=0;if(e.Client.browser==e.Client.type.Firefox||e.Client.browser==e.Client.type.IE&&8>e.Client.version&&cc)a=-2;else if(e.Client.browser==e.Client.type.Chrome||rb)a=-1;C.style.top=c.y+c.height/2-9+a+"px"}try{ib=window.setInterval(Kd,
320)}catch(m){throw bb(),Error("CL94");}}},Kd=function(){try{window.clearInterval(ib)}catch(a){throw Error("CL96");}ib=null;C.style.display="none"==C.style.display?"":"none";nd()},bb=function(){try{window.clearInterval(ib)}catch(a){throw Error("CL97");}ib=null;g(C)&&(C.style.display="none")},S=function(){bb();fc();g(C)&&g(b)&&(ba||kb(),nd(),3==q?L.position():4==q?ka.position():6!=q&&8!=q||xa())},R=function(){if(g(b.nextSibling)){if(k.right){var a=x(b.nextSibling);return a!=d.NewLine&&a!=d.Tab}return!1}return!0},
Rb=function(){if(g(b.nextSibling))for(b=b.nextSibling;g(b.nextSibling)&&!Ib(b.nextSibling);){var a=b.nextSibling;H.removeChild(b);b=a}Pa()},Fc=function(){var a=Ea?1:2,b=document.createElement("SPAN");b.id="ceQ"+H.id;H.appendChild(b);b.innerHTML='"';zb=wa(b).width+a;Ea&&cc&&(zb+=2);b.innerHTML="]";qb=wa(b).width+a;Ea&&cc&&(qb+=1);H.removeChild(b)},Sb=function(){if(!g(C)){C=document.createElement("DIV");C.id="ceR"+H.id;C.className=k.cursorOuter;C.style.position="absolute";C.style.display="none";C.style.left=
"0px";C.style.top="0px";C.style.textAlign="center";C.style.width="3px";C.style.paddingLeft="2px";var a=document.createElement("DIV");a.id="ceD"+H.id;a.className=k.cursorInner;a.style.height="18px";a.style.width="1px";C.appendChild(a);document.body.appendChild(C)}},Gc=function(a){Ea&&8<e.Client.version&&window.Modernizr&&3>Wb?Wb++:b&&Ea&&8>e.Client.version&&Ca(x(b),Z(b),Q(b),ia(b))&&g(b.getAttribute("ce207"))||(qa=0,1!=q&&2!=q&&S(),ld())},Cd=function(){if(ja){6!=q&&8!=q||xa();var a=x(b);a!=d.NewLine&&
a!=d.Tab?cb(!1):S()}},xa=function(){Vb=0;t="";E=[];za.close();q=0},Lc=function(){H.innerHTML="";var a=document.createElement("SPAN");a.className=k.emptyColor;a.style.marginTop=a.style.marginLeft=a.style.marginRight=a.style.marginBottom="0px";a.style.paddingBottom="2px";a.style.display="inline-block";a.style.whiteSpace="nowrap";a.style.cursor="default";a.innerHTML=k.els.lbl.g;H.appendChild(a);b=null},Nc=function(){g(H)&&(H.innerHTML="",H.style.color="")},Kb=function(a){if(e.getScrollHeight()>a)try{window.scroll(e.getScrollWidth(),
a)}catch(b){}},lc=function(a,b){var c=e.getWindowDimensions().height,d=e.getScrollHeight();if(c+d<a+b)try{window.scroll(e.getScrollWidth(),d+(a+b-(c+d)))}catch(g){}},Ya=function(a){return String(a).replace(/\\/g,"\\\\").replace(/'/g,"'").replace(/"/g,"&quot;")},Oa=function(a){return String(a).replace(/&#92;/g,"\\").replace(/&#39;/g,"'").replace(/&quot;/g,'"')},bd=function(a){return g(a)?a.replace("+","$"):a},Z=function(a,c){var d=parseInt(a.getAttribute("ce209"),10);return d!=h.Collection||c?d:A(w.fds,
Aa(b).getAttribute("ce208")).co},va=function(a,b){g(b)&&0<b.length&&(a.className=X(b))},ub=function(a){return"true"==a?k.els.lbl.t:k.els.lbl.f},X=function(a){return e.defined(a)?a:""},kb=function(){k.help&&lb(k.els.ms[Jd()])},Bd=function(){yb=!1},pb=function(a){return g(a)&&a.getAttribute&&"if"==a.getAttribute("ce208")},Fa=function(){return e.getChildrenByTagName(H,"SPAN",!1)},x=function(a){return parseInt(a.getAttribute("ce202"),10)},Q=function(a){return parseInt(a.getAttribute("ce203"),10)},N=function(a){return parseInt(a.getAttribute("ce204"),
10)},ia=function(a){return parseInt(a.getAttribute("ce205"),10)},pd=function(a){Sb();return vd(a)},rd=function(a){Sb();var c;if(1==q||2==q)c=!0;else{a=a.keyCode;if(16!=a){var e;8!=q&&(46==a&&g(b.nextSibling)&&(b=Jb(b.nextSibling)),e=x(b),c=Z(b,!0));switch(a){case 27:t="";if(8==q){xa();break}6==q?xa():3==q?(L.hide(),q=0):4==q&&(ka.hide(),q=0);break;case 127:t="";if(8==q){xa();break}6==q&&xa();3==q?(L.hide(),q=0):4==q?(ka.hide(),q=0):Ca(e,c,Q(b),ia(b))&&g(b.getAttribute("ce207"))||(g(b.nextSibling)?
x(b.nextSibling)==d.HtmlTag?Rb():e==d.NewLine?(ga(b),ga(b),g(b.nextSibling)&&(g(b.nextSibling)&&x(b.nextSibling)==d.Tab&&Rb(),b=F(g(b.nextSibling)?b.nextSibling:b),O(b))):pb(b)?(b=b.nextSibling,Pa()):(Pa(),g(b.nextSibling)&&(x(b.nextSibling)==d.HtmlTag&&Rb(),b=F(g(b.nextSibling)?b.nextSibling:b),O(b))):e==d.NewLine?(ga(b),ga(b)):pb(b)||Pa(),pa(b)&&Ga(b));break;case 8:t="",8==q?xa():(6==q&&xa(),3==q?(L.hide(),q=0):4==q?(ka.hide(),q=0):(Ca(e,c,Q(b),ia(b))?g(b.getAttribute("ce207"))?(e=Wa(b),2<e.length?
(c=c==h.String?'"':"]",Wa(b,e.substr(0,e.length-2)+c),b.setAttribute("ce206",e.substr(1,e.length-3))):(ra(),b=F(b),O(b)),S()):kd():e==d.RightSource?Pa():!g(b.previousSibling)||pb(b)||pb(b.previousSibling)||kd(),pa(b)&&(Ga(b),O(b))))}}c=!1}return c},qd=function(a){Sb();return wd(a)},od=function(a){Sb();ud(a)},lb=function(a){g(da)&&g(a)&&(da.innerHTML=a)}};